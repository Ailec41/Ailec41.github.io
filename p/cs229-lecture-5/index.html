<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="cs229 note"><title>CS229 Lecture 5</title><link rel=canonical href=https://lunatide.tech/p/cs229-lecture-5/><link rel=stylesheet href=https://lunatide.tech/scss/style.min.6a692fd055deae459f2a9767f57f3855ba80cafd5041317f24f7360f6ca47cdf.css><meta property='og:title' content="CS229 Lecture 5"><meta property='og:description' content="cs229 note"><meta property='og:url' content='https://lunatide.tech/p/cs229-lecture-5/'><meta property='og:site_name' content="LunaTide's Blog"><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:published_time' content='2026-01-20T00:00:00+00:00'><meta property='article:modified_time' content='2026-01-20T00:00:00+00:00'><meta property='og:image' content='https://lunatide.tech/p/cs229-lecture-5/pic1.jpg'><meta name=twitter:title content="CS229 Lecture 5"><meta name=twitter:description content="cs229 note"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://lunatide.tech/p/cs229-lecture-5/pic1.jpg'><link rel="shortcut icon" href=https://lunatide.tech/./favicon.ico></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column compact"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=åˆ‡æ¢èœå•>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=https://lunatide.tech/><img src=https://lunatide.tech/img/avatar_hu_8b8c7ec71f46c47e.jpeg width=300 height=297 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>ğŸ˜“</span></figure><div class=site-meta><h1 class=site-name><a href=https://lunatide.tech/>LunaTide's Blog</a></h1><h2 class=site-description>Welcome to my Blog</h2></div></header><ol class=menu-social><li><a href=http://codeforces.com target=_blank title=codeforces rel=me><svg viewBox="0 0 24 24" id="code-forces"><path fill="#F44336" d="M24 19.5V12a1.5 1.5.0 00-1.5-1.5h-3A1.5 1.5.0 0018 12v7.5a1.5 1.5.0 001.5 1.5h3a1.5 1.5.0 001.5-1.5z"/><path fill="#2196F3" d="M13.5 21a1.5 1.5.0 001.5-1.5v-15A1.5 1.5.0 0013.5 3h-3C9.673 3 9 3.672 9 4.5v15c0 .828.673 1.5 1.5 1.5h3z"/><path fill="#FFC107" d="M0 19.5c0 .828.673 1.5 1.5 1.5h3A1.5 1.5.0 006 19.5V9A1.5 1.5.0 004.5 7.5h-3C.673 7.5.0 8.172.0 9v10.5z"/></svg></a></li><li><a href=https://www.zhihu.com target=_blank title=Zhihu rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-brand-zhihu"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M14 6h6v12h-2l-2 2-1-2h-1z"/><path d="M4 12h6.5"/><path d="M10.5 6h-5"/><path d="M6 4c-.5 2.5-1.5 3.5-2.5 4.5"/><path d="M8 6v7c0 4.5-2 5.5-4 7"/><path d="M11 18l-3-5"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=https://lunatide.tech/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>ä¸»é¡µ</span></a></li><li><a href=https://lunatide.tech/%E5%85%B3%E4%BA%8E/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>å…³äº</span></a></li><li><a href=https://lunatide.tech/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>å½’æ¡£</span></a></li><li><a href=https://lunatide.tech/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>æœç´¢</span></a></li><li><a href=https://lunatide.tech/%E5%8F%8B%E9%93%BE/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>å‹é“¾</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>æš—è‰²æ¨¡å¼</span></li></ol></li></ol></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=https://lunatide.tech/p/cs229-lecture-5/><img src=https://lunatide.tech/p/cs229-lecture-5/pic1_hu_3824d4ba7b18be99.jpg srcset="https://lunatide.tech/p/cs229-lecture-5/pic1_hu_3824d4ba7b18be99.jpg 800w, https://lunatide.tech/p/cs229-lecture-5/pic1_hu_d4ff581470c2f562.jpg 1600w" width=800 height=419 loading=lazy alt="Featured image of post CS229 Lecture 5"></a></div><div class=article-details><header class=article-category><a href=https://lunatide.tech/categories/deep-learning/>Deep Learning
</a><a href=https://lunatide.tech/categories/cs229/>CS229</a></header><div class=article-title-wrapper><h2 class=article-title><a href=https://lunatide.tech/p/cs229-lecture-5/>CS229 Lecture 5</a></h2><h3 class=article-subtitle>cs229 note</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>2026-01-20</time></div></footer></div></header><section class=article-content><h2 id=ç”Ÿæˆå­¦ä¹ ç®—æ³•>ç”Ÿæˆå­¦ä¹ ç®—æ³•</h2><p>ç›®å‰ä¸ºæ­¢è¯´è¿‡çš„å­¦ä¹ ç®—æ³•çš„æ¨¡å‹éƒ½æ˜¯$p(y \mid x;\theta)$ï¼Œä¹Ÿå°±æ˜¯ç»™å®š$x$ä¸‹çš„$y$çš„æ¡ä»¶åˆ†å¸ƒï¼Œä»¥$\theta$ä¸ºå‚æ•°ã€‚ä¾‹å¦‚ï¼Œé€»è¾‘å›å½’å°±æ˜¯ä»¥$h_{\theta}(x)=g(\theta^Tx)$ä½œä¸º$p(y \mid x;\theta)$çš„æ¨¡å‹ï¼Œè¿™é‡Œçš„$g$æ˜¯ä¸€ä¸ªsigmoidå‡½æ•°ï¼Œæ¥ä¸‹æ¥è¦è®²ä¸€ä¸ªä¸åŒç±»å‹çš„å­¦ä¹ ç®—æ³•ã€‚</p><p>è®¾æƒ³æœ‰è¿™æ ·çš„ä¸€ç§åˆ†ç±»é—®é¢˜ï¼Œæˆ‘ä»¬è¦å­¦ä¹ åŸºäºä¸€ä¸ªåŠ¨ç‰©çš„æŸä¸ªç‰¹å¾æ¥è¾¨åˆ«å®ƒæ˜¯å¤§è±¡(y=1)è¿˜æ˜¯å°ç‹—(y=0)ã€‚ç»™å®šä¸€ä¸ªè®­ç»ƒé›†ï¼Œç”¨é€»è¾‘å›å½’æˆ–è€…åŸºç¡€ç‰ˆçš„æ„ŸçŸ¥å™¨ç®—æ³•è¿™æ ·çš„ä¸€ä¸ªç®—æ³•èƒ½æ‰¾åˆ°ä¸€æ¡ç›´çº¿ï¼Œä½œä¸ºåŒºåˆ†å¤§è±¡å’Œå°ç‹—çš„è¾¹ç•Œã€‚ç„¶åæˆ‘ä»¬åªè¦çœ‹å€¼è½åœ¨å“ªä¸ªåŒºåŸŸå°±å¯ä»¥åˆ†è¾¨å‡ºæ˜¯å¤§è±¡è¿˜æ˜¯å°ç‹—ã€‚</p><p>æˆ–è€…è¿˜æœ‰å¦å¤–ä¸€ç§ç®—æ³•ã€‚é¦–å…ˆï¼Œè§‚å¯Ÿå¤§è±¡ï¼Œç„¶åæˆ‘ä»¬é’ˆå¯¹å¤§è±¡çš„æ ·å­æ¥è¿›è¡Œå»ºæ¨¡ã€‚ç„¶åå†è§‚å¯Ÿå°ç‹—ï¼Œé’ˆå¯¹å°ç‹—çš„æ ·å­å¦å¤–å»ºç«‹ä¸€ä¸ªæ¨¡å‹ã€‚æœ€åæˆ‘ä»¬åªéœ€è¦æŠŠåŠ¨ç‰©å’Œè¿™ä¸¤ä¸ªæ¨¡å‹æ¯”å¯¹ï¼Œè¶Šæ¥è¿‘å“ªä¸ªå°±æ˜¯å“ªä¸ªåŠ¨ç‰©ã€‚</p><p>ä¾‹å¦‚é€»è¾‘å›å½’ä¹‹ç±»çš„ç›´æ¥è¯•å›¾å»ºç«‹$p(y \mid x)$çš„ç®—æ³•ï¼Œä»¥åŠæ„ŸçŸ¥å™¨ç®—æ³•ç­‰ç›´æ¥ç”¨æŠ•å›¾çš„æ€è·¯æ¥åˆ¤æ–­å¯¹åº”$X$çš„å€¼è½åˆ°äº†{0ï¼Œ1}ä¸­å“ªä¸ªåŒºåŸŸçš„ç®—æ³•ï¼Œè¿™äº›éƒ½å«åˆ¤åˆ«å¼å­¦ä¹ ç®—æ³•ã€‚å’Œä¹‹å‰çš„è¿™äº›åˆ¤åˆ«å¼ç®—æ³•ä¸åŒï¼Œä¸‹é¢æˆ‘ä»¬è¦è®²çš„æ–°ç®—æ³•æ˜¯å¯¹$p(y \mid x)$å’Œ$p(y)$æ¥è¿›è¡Œå»ºæ¨¡ã€‚è¿™ç±»ç®—æ³•å«åš<strong>ç”Ÿæˆå­¦ä¹ ç®—æ³•</strong>ã€‚ä¾‹å¦‚å¦‚æœ$y$æ˜¯ç”¨æ¥è¡¨ç¤ºä¸€ä¸ªæ ·ä¾‹æ˜¯å°ç‹—(0)æˆ–è€…å¤§è±¡(1)ï¼Œé‚£ä¹ˆ$p(x \mid y=0)$å°±æ˜¯å¯¹å°ç‹—ç‰¹å¾çš„åˆ†å¸ƒçš„å»ºæ¨¡ï¼Œåä¹‹ï¼Œ$p(x \mid y=1)$å°±æ˜¯å¯¹å¤§è±¡ç‰¹å¾åˆ†å¸ƒçš„å»ºæ¨¡ã€‚</p><p>åœ¨å¯¹ $p(y)$ï¼ˆç§°ä¸º<strong>åˆ†ç±»å…ˆéªŒ</strong>ï¼‰å’Œ $p(x \mid y)$ è¿›è¡Œå»ºæ¨¡ä¹‹åï¼Œæˆ‘ä»¬çš„ç®—æ³•å¯ä»¥ä½¿ç”¨è´å¶æ–¯æ³•åˆ™åœ¨ç»™å®š $x$ çš„æƒ…å†µä¸‹è¾“å‡ºåéªŒåˆ†å¸ƒï¼š</p>$$
p(y \mid x) = \frac{p(x \mid y)p(y)}{p(x)}.
$$<p>è¿™é‡Œï¼Œåˆ†æ¯</p>$$
p(x) = p(x \mid y=1)p(y=1) + p(x \mid y=0)p(y=0)
$$<p>ç»™å‡ºï¼Œå› æ­¤ä¹Ÿå¯ä»¥ç”¨æˆ‘ä»¬å­¦ä¹ åˆ°çš„ $p(x \mid y)$ å’Œ $p(y)$ è¡¨ç¤ºã€‚å®é™…ä¸Šï¼Œå¦‚æœä¸ºäº†è¿›è¡Œé¢„æµ‹è€Œè®¡ç®— $p(y \mid x)$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å®é™…ä¸Šå¹¶ä¸éœ€è¦è®¡ç®—åˆ†æ¯ï¼Œå› ä¸º</p>$$
\arg\max_y p(y \mid x)
= \arg\max_y \frac{p(x \mid y)p(y)}{p(x)}
= \arg\max_y p(x \mid y)p(y).
$$<h3 id=é«˜æ–¯åˆ¤åˆ«åˆ†æ>é«˜æ–¯åˆ¤åˆ«åˆ†æ</h3><p>æˆ‘ä»¬è¦å­¦ä¹ çš„ç¬¬ä¸€ä¸ªç”Ÿæˆå­¦ä¹ ç®—æ³•å°±æ˜¯é«˜æ–¯åˆ¤åˆ«åˆ†æï¼Œåœ¨è¿™ä¸ªæ¨¡å‹é‡Œé¢ï¼Œæˆ‘ä»¬å‡è®¾$p(x \mid y)$æ˜¯ä¸€ä¸ªå¤šå…ƒæ­£æ€åˆ†å¸ƒã€‚æ‰€ä»¥é¦–å…ˆæˆ‘ä»¬ç®€å•è®²ä¸‹å¤šå…ƒæ­£æ€åˆ†å¸ƒçš„ä¸€äº›ç‰¹ç‚¹</p><h4 id=å¤šå…ƒæ­£æ€åˆ†å¸ƒ>å¤šå…ƒæ­£æ€åˆ†å¸ƒ</h4><p>$n$ ç»´çš„å¤šå…ƒæ­£æ€åˆ†å¸ƒï¼Œä¹Ÿç§°ä¸ºå¤šå…ƒé«˜æ–¯åˆ†å¸ƒï¼Œç”±<strong>å‡å€¼å‘é‡</strong> $\mu \in \mathbb{R}^n$ ä»¥åŠ<strong>åæ–¹å·®çŸ©é˜µ</strong>$\Sigma \in \mathbb{R}^{n \times n}$ å‚æ•°åŒ–ï¼Œå…¶ä¸­ $\Sigma \ge 0$ æ˜¯åŠæ­£å®šå¯¹ç§°çŸ©é˜µã€‚å¤šå…ƒæ­£æ€åˆ†å¸ƒä¹Ÿå†™ä¸º $\mathcal{N}(\mu, \Sigma)$ï¼Œå…¶å¯†åº¦ç”±ä¸‹å¼ç»™å‡ºï¼š</p>$$
p(x; \mu, \Sigma)
= \frac{1}{(2\pi)^{n/2} \lvert \Sigma \rvert^{1/2}}
\exp\!\left(
-\frac{1}{2}(x-\mu)^T \Sigma^{-1} (x-\mu)
\right).
$$<p>åœ¨ä¸Šé¢çš„ç­‰å¼ä¸­ï¼Œâ€œ$|\Sigma|$â€çš„æ„æ€æ˜¯çŸ©é˜µ $\Sigma$ çš„è¡Œåˆ—å¼ï¼Œå¯¹äºä¸€ä¸ªåœ¨ $\mathcal{N}(\mu,\Sigma)$ åˆ†å¸ƒä¸­çš„éšæœºå˜é‡ $X$ï¼Œå…¶å¹³å‡å€¼å°±æ˜¯$\mu$äº†</p>$$
E[X] = \int_x x\, p(x;\mu,\Sigma)\, dx = \mu.
$$<p>å‘é‡å€¼éšæœºå˜é‡ $Z$ çš„<strong>åæ–¹å·®</strong>å®šä¹‰ä¸º$\mathrm{Cov}(Z) = E[(Z - E[Z])(Z - E[Z])^T]$ã€‚è¿™æ¦‚æ‹¬äº†å®å€¼éšæœºå˜é‡æ–¹å·®çš„æ¦‚å¿µã€‚åæ–¹å·®ä¹Ÿå¯ä»¥å®šä¹‰ä¸º$\mathrm{Cov}(Z) = E[ZZ^T] - (E[Z])(E[Z])^T$ã€‚å¦‚æœ $X \sim \mathcal{N}(\mu,\Sigma)$ï¼Œé‚£ä¹ˆ</p>$$
\mathrm{Cov}(X) = \Sigma
$$<h4 id=é«˜æ–¯åˆ¤åˆ«åˆ†ææ¨¡å‹>é«˜æ–¯åˆ¤åˆ«åˆ†ææ¨¡å‹</h4><p>å‡å¦‚æˆ‘ä»¬æœ‰ä¸€ä¸ªåˆ†ç±»é—®é¢˜ï¼Œå…¶ä¸­è¾“å…¥ç‰¹å¾$x$æ˜¯ä¸€ç³»åˆ—çš„è¿ç»­éšæœºå˜é‡ï¼Œé‚£å°±å¯ä»¥ä½¿ç”¨é«˜æ–¯åˆ¤åˆ«åˆ†ææ¨¡å‹ï¼Œå…¶ä¸­å¯¹$p(x \mid y)$ç”¨å¤šå…ƒæ­£æ€åˆ†å¸ƒæ¥è¿›è¡Œå»ºæ¨¡ï¼Œè¿™ä¸ªæ¨¡å‹ä¸ºï¼š</p>$$
\begin{array}{c}
y \sim \mathrm{Bernoulli}(\phi) \\
x \mid y=0 \sim \mathcal{N}(\mu_0,\Sigma) \\
x \mid y=1 \sim \mathcal{N}(\mu_1,\Sigma)
\end{array}
$$<p>åˆ†å¸ƒå†™å‡ºæ¥çš„å…·ä½“å½¢å¼å¦‚ä¸‹ï¼š</p>$$
\begin{array}{rcl}
p(y) &=& \phi^y(1-\phi)^{1-y} \\
p(x \mid y=0) &=& \dfrac{1}{(2\pi)^{n/2}\,|\Sigma|^{1/2}}
\exp\!\left(-\dfrac{1}{2}(x-\mu_0)^T\Sigma^{-1}(x-\mu_0)\right) \\
p(x \mid y=1) &=& \dfrac{1}{(2\pi)^{n/2}\,|\Sigma|^{1/2}}
\exp\!\left(-\dfrac{1}{2}(x-\mu_1)^T\Sigma^{-1}(x-\mu_1)\right)
\end{array}
$$<p>è¿™é‡Œï¼Œæˆ‘ä»¬çš„æ¨¡å‹çš„å‚æ•°æ˜¯ $\phi, \Sigma, \mu_0, \mu_1$ã€‚ï¼ˆè™½ç„¶å­˜åœ¨ä¸¤ä¸ªä¸åŒçš„å‡å€¼å‘é‡ $\mu_0$ å’Œ $\mu_1$ï¼Œä½†æ˜¯è¯¥æ¨¡å‹é€šå¸¸ä»…ä½¿ç”¨åŒä¸€ä¸ªåæ–¹å·®çŸ©é˜µ $\Sigma$ã€‚ï¼‰æ•°æ®çš„å¯¹æ•°ä¼¼ç„¶æ€§ç”±ä¸‹å¼ç»™å‡ºï¼š</p>$$
\ell(\phi,\mu_0,\mu_1,\Sigma)
= \log \prod_{i=1}^m p(x^{(i)}, y^{(i)};\phi,\mu_0,\mu_1,\Sigma)
$$$$
= \log \prod_{i=1}^m
p(x^{(i)} \mid y^{(i)};\mu_0,\mu_1,\Sigma)\,
p(y^{(i)};\phi).
$$<p>é€šè¿‡å‚æ•°æœ€å¤§åŒ–$l$ï¼Œç„¶åå°±èƒ½æ‰¾åˆ°è¯¥å‚æ•°ç»„åˆå¯¹åº”çš„æœ€å¤§ä¼¼ç„¶ä¼°è®¡å¦‚ä¸‹</p>$$
\begin{array}{rcl}
\phi
&=& \dfrac{1}{m}\displaystyle\sum_{i=1}^m 1\{y^{(i)} = 1\} \\
\mu_0
&=& \dfrac{\displaystyle\sum_{i=1}^m 1\{y^{(i)} = 0\}\, x^{(i)}}
{\displaystyle\sum_{i=1}^m 1\{y^{(i)} = 0\}} \\
\mu_1
&=& \dfrac{\displaystyle\sum_{i=1}^m 1\{y^{(i)} = 1\}\, x^{(i)}}
{\displaystyle\sum_{i=1}^m 1\{y^{(i)} = 1\}} \\
\Sigma
&=& \dfrac{1}{m}\displaystyle\sum_{i=1}^m
\big(x^{(i)} - \mu_{y^{(i)}}\big)
\big(x^{(i)} - \mu_{y^{(i)}}\big)^T
\end{array}
$$<p>æ¨å¯¼è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><p>å…ˆè§‚å¯Ÿ $P(x \mid y)$ çš„å½¢å¼ï¼Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹å…¬å¼</p>$$
P(x\mid y)=\frac{1}{(2\pi)^{n/2}\,|\Sigma|^{1/2}}
\exp\!\left(-\frac{1}{2}(x-\mu_y)^{T}\Sigma^{-1}(x-\mu_y)\right)
$$<p>æ¥ç€è®¡ç®— $\log P(x,y)$</p>$$
\begin{array}{rcl}
\log P(x,y)
& = &
\log P(x\mid y)P(y)\\
& = &
\log\Bigg(
\frac{1}{(2\pi)^{n/2}\lvert\Sigma\rvert^{1/2}}
\exp\!\left(
-\frac{1}{2}(x-\mu_y)^T\Sigma^{-1}(x-\mu_y)
\right)
\phi^{1(y=1)}
(1-\phi)^{1(y=0)}
\Bigg)\\
& = &
\,-\frac{n}{2}\log(2\pi)
\,-\frac{1}{2}\log\lvert\Sigma\rvert
\,-\frac{1}{2}(x-\mu_y)^T\Sigma^{-1}(x-\mu_y)+ 1(y=1)\log\phi+ 1(y=0)\log(1-\phi)
\end{array}
$$<p>å¯¹æ•°ä¼¼ç„¶å‡½æ•°ä¸ºï¼š</p>$$
\begin{aligned}
\ell(\phi,\mu_0,\mu_1,\Sigma)
&= \log\prod_{i=1}^{m} p(x^{(i)},y^{(i)};\phi,\mu_0,\mu_1,\Sigma) \\
&= \sum_{i=1}^{m}
\log p(x^{(i)},y^{(i)};\phi,\mu_0,\mu_1,\Sigma) \\
&= \sum_{i=1}^{m}\Bigg(
\log\frac{1}{(2\pi)^{n/2}\det(\Sigma)^{1/2}}
-\frac{1}{2}(x^{(i)}-\mu_{y^{(i)}})^T
\Sigma^{-1}(x^{(i)}-\mu_{y^{(i)}})+ 1(y^{(i)}=1)\log\phi+ 1(y^{(i)}=0)\log(1-\phi)
\Bigg)
\end{aligned}
$$<p>å…³äº $\phi$ æ±‚æ¢¯åº¦</p>$$
\begin{array}{rcl}
\displaystyle\frac{\partial \ell}{\partial \phi}
&=& \displaystyle
\sum_{i=1}^{m}
\left(
\frac{\mathbf{1}\{y^{(i)}=1\}}{\phi}
-\frac{\mathbf{1}\{y^{(i)}=0\}}{1-\phi}
\right)
= 0
&\Longrightarrow&
\displaystyle\sum_{i=1}^{m}\mathbf{1}\{y^{(i)}=1\}
= m\phi
&\Longrightarrow&
\displaystyle
\phi=\frac{1}{m}\sum_{i=1}^{m}\mathbf{1}\{y^{(i)}=1\}
\end{array}
$$<p>å…³äº $\mu_1,\mu_0$ æ±‚æ¢¯åº¦</p>$$
\begin{array}{rcl}
\nabla_{\mu_1}\ell
&=& \displaystyle
\sum_{i=1}^{m}
\Sigma^{-1}(x^{(i)}-\mu_{y^{(i)}})\,
1_{y^{(i)}=1}
= 0
&\Longrightarrow&
\sum_{i=1}^{m}
(x^{(i)}-\mu_1)\,
1_{y^{(i)}=1}
= 0
&\Longrightarrow&
\mu_1=\frac{\sum_{i=1}^{m} \mathbf{1}\{y^{(i)} = 0\} \, x^{(i)}}{\sum_{i=1}^{m} \mathbf{1}\{y^{(i)} = 0\}}
\end{array}
$$<p>å…³äº $\Sigma$ çš„æå¤§ä¼¼ç„¶ä¼°è®¡</p>$$
\nabla_A \log|A| = (A^{-1})^T,
\nabla_A(x^T A y) = xy^T
$$$$
\begin{array}{rcl}
\nabla_{\Sigma^{-1}}\ell
&=& \nabla_{\Sigma^{-1}}
\left(
\frac{m}{2}\log|\Sigma^{-1}|
\right)
-\frac{1}{2}\nabla_{\Sigma^{-1}}
\sum_{i=1}^{m}
(x^{(i)}-\mu_{y^{(i)}})^T
\Sigma^{-1}
(x^{(i)}-\mu_{y^{(i)}})
= 0
&\Longrightarrow&
\displaystyle
\frac{m}{2}\Sigma
-\frac{1}{2}\sum_{i=1}^{m}
(x^{(i)}-\mu_{y^{(i)}})
(x^{(i)}-\mu_{y^{(i)}})^T
= 0
&\Longrightarrow&
\displaystyle
\Sigma
=\frac{1}{m}\sum_{i=1}^{m}
(x^{(i)}-\mu_{y^{(i)}})
(x^{(i)}-\mu_{y^{(i)}})^T
\end{array}
$$<p>å› æ­¤ç»“è®ºæˆç«‹ã€‚</p><h3 id=è®¨è®ºé«˜æ–¯åˆ¤åˆ«åˆ†æä¸logisticå›å½’>è®¨è®ºï¼šé«˜æ–¯åˆ¤åˆ«åˆ†æä¸logisticå›å½’</h3><p>é«˜æ–¯åˆ¤åˆ«åˆ†ææ¨¡å‹ä¸é€»è¾‘å›å½’æœ‰å¾ˆæœ‰è¶£çš„ç›¸å…³æ€§ã€‚å¦‚æœæˆ‘ä»¬æŠŠå˜é‡ $ p(y = 1 \mid x; \phi, \mu_0, \mu_1, \Sigma) $ä½œä¸ºä¸€ä¸ª \(x\) çš„å‡½æ•°ï¼Œå°±ä¼šå‘ç°å¯ä»¥ç”¨å¦‚ä¸‹çš„å½¢å¼æ¥è¡¨è¾¾ï¼š</p>$$
p(y = 1 \mid x; \phi, \Sigma, \mu_0, \mu_1)=\frac{1}{1 + \exp(-\theta^T x)}
$$<p>å…¶ä¸­çš„ \(\theta\) æ˜¯å¯¹ \(\phi, \Sigma, \mu_0, \mu_1\) çš„æŸç§å‡½æ•°ã€‚è¿™å°±æ˜¯é€»è¾‘å›å½’ï¼ˆä¹Ÿæ˜¯ä¸€ç§åˆ¤åˆ«åˆ†æç®—æ³•ï¼‰ç”¨æ¥å¯¹\( p(y = 1 \mid x) \)å»ºæ¨¡çš„å½¢å¼ã€‚</p><p>Proofï¼š</p><p>å…ˆè®¡ç®— \( P(x) \)</p>$$
P(x)=P(y = 1) P(x \mid y = 1)+P(y = 0) P(x \mid y = 0)
$$$$
\left.
\begin{array}{l}
P(x)=
\phi
\dfrac{1}{(2\pi)^{n/2}|\Sigma|^{1/2}}
\exp\!\left(-\dfrac{1}{2}(x-\mu_1)^T \Sigma^{-1}(x-\mu_1)
\right)+
(1-\phi)
\dfrac{1}{(2\pi)^{n/2}|\Sigma|^{1/2}}
\exp\!\left(-\dfrac{1}{2}(x-\mu_0)^T \Sigma^{-1}(x-\mu_0)
\right)
\end{array}
\right.
$$<p>åˆ©ç”¨è´å¶æ–¯å…¬å¼è®¡ç®— \( P(y \mid x) \)ï¼Œåˆ†åˆ«å¯¹ \( y = 1, y = 0 \) è®¡ç®—ï¼š</p>$$
P(y \mid x)=
\frac{P(x \mid y) P(y)}{P(x)}
$$<p>å› æ­¤ï¼Œ</p>$$
\left.
\begin{array}{lcl}
P(y=1 \mid x)
& = &
\dfrac{P(x \mid y=1)P(y=1)}
{\phi \dfrac{1}{(2\pi)^{n/2}|\Sigma|^{1/2}}
\exp\!\left(-\dfrac12 (x-\mu_1)^T\Sigma^{-1}(x-\mu_1)\right)
+(1-\phi)\dfrac{1}{(2\pi)^{n/2}|\Sigma|^{1/2}}
\exp\!\left(-\dfrac12 (x-\mu_0)^T\Sigma^{-1}(x-\mu_0)\right)} \\[1em]
& = &
\dfrac{\dfrac{1}{(2\pi)^{n/2}|\Sigma|^{1/2}}
\exp\!\left(-\dfrac12 (x-\mu_1)^T\Sigma^{-1}(x-\mu_1)\right)\phi}
{\phi \dfrac{1}{(2\pi)^{n/2}|\Sigma|^{1/2}}
\exp\!\left(-\dfrac12 (x-\mu_1)^T\Sigma^{-1}(x-\mu_1)\right)
+(1-\phi)\dfrac{1}{(2\pi)^{n/2}|\Sigma|^{1/2}}
\exp\!\left(-\dfrac12 (x-\mu_0)^T\Sigma^{-1}(x-\mu_0)\right)} \\[1em]
& = &
\dfrac{1}
{1+\dfrac{1-\phi}{\phi}
\exp\!\left(
-\dfrac12 (x-\mu_0)^T\Sigma^{-1}(x-\mu_0)
+\dfrac12 (x-\mu_1)^T\Sigma^{-1}(x-\mu_1)
\right)}
\end{array}
\right.
$$<p>è®¡ç®—æŒ‡æ•°éƒ¨åˆ†</p>$$
\left.
\begin{array}{lcl}-\dfrac12 (x-\mu_0)^T\Sigma^{-1}(x-\mu_0)+ \dfrac12 (x-\mu_1)^T\Sigma^{-1}(x-\mu_1)& = &
\dfrac{1}{2}
\Big(
x^T\Sigma^{-1}x- 2\mu_1^T\Sigma^{-1}x+ \mu_1^T\Sigma^{-1}\mu_1 - x^T\Sigma^{-1}x+ 2\mu_0^T\Sigma^{-1}x- \mu_0^T\Sigma^{-1}\mu_0
\Big) \\& = &
\dfrac{1}{2}
\Big(
2(\mu_0^T\Sigma^{-1}-\mu_1^T\Sigma^{-1})x+ \mu_1^T\Sigma^{-1}\mu_1- \mu_0^T\Sigma^{-1}\mu_0
\Big) \\& = &
(\mu_0^T\Sigma^{-1}-\mu_1^T\Sigma^{-1})x+ \dfrac{1}{2}
\big(
\mu_1^T\Sigma^{-1}\mu_1- \mu_0^T\Sigma^{-1}\mu_0
\big)
\end{array}
\right.
$$<p>so</p>$$
\left.
\begin{array}{lcl}
P(y=1 \mid x)
& = &
\dfrac{1}
{1 + \dfrac{1-\phi}{\phi}
\exp\!\left(
(\mu_0^T\Sigma^{-1}-\mu_1^T\Sigma^{-1})x+ \dfrac12(\mu_1^T\Sigma^{-1}\mu_1-\mu_0^T\Sigma^{-1}\mu_0)
\right)} \\
& = &
\dfrac{1}
{1 + \exp\!\left(
(\mu_0^T\Sigma^{-1}-\mu_1^T\Sigma^{-1})x+ \dfrac12(\mu_1^T\Sigma^{-1}\mu_1-\mu_0^T\Sigma^{-1}\mu_0)+ \ln\dfrac{1-\phi}{\phi}
\right)}
\end{array}
\right.
$$<p>ä»¤</p>$$
\left.
\theta=
(\mu_1^T\Sigma^{-1}-\mu_0^T\Sigma^{-1})^T= \Sigma^{-1}(\mu_1-\mu_0) \qquad
\theta_0=-\dfrac12(\mu_1^T\Sigma^{-1}\mu_1-\mu_0^T\Sigma^{-1}\mu_0)- \ln\dfrac{1-\phi}{\phi}
\right.
$$<p>ä»è€Œ</p>$$
\left.
p(y=1 \mid x;\phi,\Sigma,\mu_0,\mu_1)=
\dfrac{1}{1+\exp\!\big(-(\theta^T x+\theta_0)\big)}
\right.
$$<p>é‚£ä¹ˆè¿™ä¸¤ä¸ªæ¨¡å‹ï¼Œæˆ‘ä»¬åº”è¯¥å¦‚ä½•é€‰æ‹©å‘¢ï¼Ÿä¸€èˆ¬æ¥è¯´ï¼Œé«˜æ–¯åˆ¤åˆ«åˆ†æå’Œlogisticå›å½’ï¼Œå¯¹åŒä¸€ä¸ªè®­ç»ƒé›†ï¼Œå¯èƒ½ç»™å‡ºçš„åˆ¤åˆ«æ›²çº¿æ˜¯ä¸ä¸€æ ·çš„ã€‚å“ªä¸€ä¸ªæ›´å¥½ä¸€ç‚¹å‘¢ï¼Ÿ</p></section><footer class=article-footer></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js integrity=sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8 crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".main-article");renderMathInElement(e,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],ignoredClasses:["gist"]})})</script></article><aside class=related-content--wrapper><h2 class=section-title>ç›¸å…³æ–‡ç« </h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=https://lunatide.tech/p/cs229-lecture-7/><div class=article-image><img src=https://lunatide.tech/p/cs229-lecture-7/pic1.e3fe3f7deb19da40529efe3fac8bb5cd_hu_aa0783468c169fc4.jpg width=250 height=150 loading=lazy alt="Featured image of post CS229 Lecture 7" data-hash="md5-4/4/fesZ2kBSnv4/rIu1zQ=="></div><div class=article-details><h2 class=article-title>CS229 Lecture 7</h2></div></a></article><article class=has-image><a href=https://lunatide.tech/p/cs229-lecture-6/><div class=article-image><img src=https://lunatide.tech/p/cs229-lecture-6/pic1.e3fe3f7deb19da40529efe3fac8bb5cd_hu_aa0783468c169fc4.jpg width=250 height=150 loading=lazy alt="Featured image of post CS229 Lecture 6" data-hash="md5-4/4/fesZ2kBSnv4/rIu1zQ=="></div><div class=article-details><h2 class=article-title>CS229 Lecture 6</h2></div></a></article><article class=has-image><a href=https://lunatide.tech/p/cs229-lecture-52/><div class=article-image><img src=https://lunatide.tech/p/cs229-lecture-52/pic1.e3fe3f7deb19da40529efe3fac8bb5cd_hu_aa0783468c169fc4.jpg width=250 height=150 loading=lazy alt="Featured image of post CS229 Lecture 5(2)" data-hash="md5-4/4/fesZ2kBSnv4/rIu1zQ=="></div><div class=article-details><h2 class=article-title>CS229 Lecture 5(2)</h2></div></a></article><article class=has-image><a href=https://lunatide.tech/p/cs229-lecture-4/><div class=article-image><img src=https://lunatide.tech/p/cs229-lecture-4/pic1.e3fe3f7deb19da40529efe3fac8bb5cd_hu_aa0783468c169fc4.jpg width=250 height=150 loading=lazy alt="Featured image of post CS229 Lecture 4" data-hash="md5-4/4/fesZ2kBSnv4/rIu1zQ=="></div><div class=article-details><h2 class=article-title>CS229 Lecture 4</h2></div></a></article><article class=has-image><a href=https://lunatide.tech/p/cs229-lecture-3/><div class=article-image><img src=https://lunatide.tech/p/cs229-lecture-3/pic1.e3fe3f7deb19da40529efe3fac8bb5cd_hu_aa0783468c169fc4.jpg width=250 height=150 loading=lazy alt="Featured image of post CS229 Lecture 3" data-hash="md5-4/4/fesZ2kBSnv4/rIu1zQ=="></div><div class=article-details><h2 class=article-title>CS229 Lecture 3</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2025 -
2026 LunaTide's Blog</section><section class=powerby>ä½¿ç”¨ <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> æ„å»º<br>ä¸»é¢˜ <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.31.0>Stack</a></b> ç”± <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> è®¾è®¡</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=https://lunatide.tech/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>