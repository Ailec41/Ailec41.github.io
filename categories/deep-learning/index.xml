<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Deep Learning on LunaTide's Blog</title><link>https://lunatide.tech/categories/deep-learning/</link><description>Recent content in Deep Learning on LunaTide's Blog</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><copyright>LunaTide's Blog</copyright><lastBuildDate>Wed, 26 Nov 2025 00:00:00 +0000</lastBuildDate><atom:link href="https://lunatide.tech/categories/deep-learning/index.xml" rel="self" type="application/rss+xml"/><item><title>CS231 ç¬¬ä¸‰è®² æ­£åˆ™åŒ–ä¸ä¼˜åŒ–</title><link>https://lunatide.tech/p/cs231-%E7%AC%AC%E4%B8%89%E8%AE%B2-%E6%AD%A3%E5%88%99%E5%8C%96%E4%B8%8E%E4%BC%98%E5%8C%96/</link><pubDate>Wed, 26 Nov 2025 00:00:00 +0000</pubDate><guid>https://lunatide.tech/p/cs231-%E7%AC%AC%E4%B8%89%E8%AE%B2-%E6%AD%A3%E5%88%99%E5%8C%96%E4%B8%8E%E4%BC%98%E5%8C%96/</guid><description>&lt;img src="https://lunatide.tech/p/cs231-%E7%AC%AC%E4%B8%89%E8%AE%B2-%E6%AD%A3%E5%88%99%E5%8C%96%E4%B8%8E%E4%BC%98%E5%8C%96/pic1.jpg" alt="Featured image of post CS231 ç¬¬ä¸‰è®² æ­£åˆ™åŒ–ä¸ä¼˜åŒ–" /&gt;&lt;h2 id="æŸå¤±å‡½æ•°"&gt;æŸå¤±å‡½æ•°
&lt;/h2&gt;&lt;p&gt;ç»™å®šä¸€ä¸ªå›¾ç‰‡æ•°æ®é›† ${(x_i, y_i)}_{i=1}^N$ï¼Œ$x_i$ ä¸ºå›¾ç‰‡ï¼Œ$y_i$ ä¸ºæ ‡ç­¾ï¼ŒæŸå¤±ä¸º
&lt;/p&gt;
$$
L = \frac{1}{N} \sum_i L_i(f(x_i, W), y_i) \tag{1}
$$&lt;p&gt;
è¿™æ˜¯ä¸€ç§è¡¡é‡æ¨¡å‹é¢„æµ‹ä¸è®­ç»ƒæ•°æ®åŒ¹é…ç¨‹åº¦çš„æŸå¤±ï¼Œæˆ‘ä»¬å¸Œæœ›è¿™ä¸ªå€¼è¶Šä½è¶Šå¥½ï¼Œè¿™ä»£è¡¨æ¨¡å‹å¾ˆå¥½åœ°æ‹Ÿåˆäº†è®­ç»ƒæ•°æ®&lt;/p&gt;
&lt;h3 id="å¤šç±»svmæŸå¤±"&gt;å¤šç±»SVMæŸå¤±
&lt;/h3&gt;&lt;p&gt;ç»™ä¸€ä¸ª$s=f(x_i,W)$&lt;/p&gt;
&lt;p&gt;SVMæŸå¤±å®šä¹‰ä¸º
&lt;/p&gt;
$$
\begin{aligned}
L_i &amp;= \sum_{j \neq y_i} \begin{cases} 0 &amp; \text{å¦‚æœ} s_{y_i} \ge s_j + 1 \\ s_j - s_{y_i} + 1 &amp; \text{å…¶ä»–} \end{cases} \\
&amp;= \sum_{j \neq y_i} \max(0, s_j - s_{y_i} + 1)
\end{aligned}\tag{2}
$$&lt;p&gt;
SVMæŸå¤±å‡½æ•°çš„å½¢å¼å¦‚ä¸‹
&lt;/p&gt;
$$
L_i = \sum_{j \neq y_i} \max(0, s_j - s_{y_i} + 1)\tag{3}
$$&lt;p&gt;
&lt;img src="https://lunatide.tech/p/cs231-%E7%AC%AC%E4%B8%89%E8%AE%B2-%E6%AD%A3%E5%88%99%E5%8C%96%E4%B8%8E%E4%BC%98%E5%8C%96/p4.jpg"
width="440"
height="330"
srcset="https://lunatide.tech/p/cs231-%E7%AC%AC%E4%B8%89%E8%AE%B2-%E6%AD%A3%E5%88%99%E5%8C%96%E4%B8%8E%E4%BC%98%E5%8C%96/p4_hu_a9dfe09e6f57ef1f.jpg 480w, https://lunatide.tech/p/cs231-%E7%AC%AC%E4%B8%89%E8%AE%B2-%E6%AD%A3%E5%88%99%E5%8C%96%E4%B8%8E%E4%BC%98%E5%8C%96/p4_hu_37ad7b737d874a5a.jpg 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="133"
data-flex-basis="320px"
&gt;&lt;/p&gt;
&lt;h3 id="softmaxåˆ†ç±»å™¨"&gt;Softmaxåˆ†ç±»å™¨
&lt;/h3&gt;&lt;p&gt;é¦–å…ˆå®šä¹‰å¦‚ä¸‹æ¦‚ç‡&lt;/p&gt;
$$
P(Y = k | X = x_i) = \frac{e^{s_k}}{\sum_j e^{s_j}} \quad s = f(x_i; W)\tag{4}
$$&lt;p&gt;æˆ‘ä»¬æƒ³æœ€å¤§åŒ–å¯¹æ•°ä¼¼ç„¶å‡½æ•°ï¼Œè€Œè¿™ä¹Ÿç­‰ä»·äºæœ€å°åŒ–å¦‚ä¸‹å¼å­&lt;/p&gt;
$$
L_i = -\log P(Y = y_i | X = x_i) = -\log \left( \frac{e^{s_{y_i}}}{\sum_j e^{s_j}} \right)\tag{5}
$$&lt;p&gt;
&lt;img src="https://lunatide.tech/p/cs231-%E7%AC%AC%E4%B8%89%E8%AE%B2-%E6%AD%A3%E5%88%99%E5%8C%96%E4%B8%8E%E4%BC%98%E5%8C%96/p2.jpg"
width="1914"
height="926"
srcset="https://lunatide.tech/p/cs231-%E7%AC%AC%E4%B8%89%E8%AE%B2-%E6%AD%A3%E5%88%99%E5%8C%96%E4%B8%8E%E4%BC%98%E5%8C%96/p2_hu_74ebdaed0ff057b1.jpg 480w, https://lunatide.tech/p/cs231-%E7%AC%AC%E4%B8%89%E8%AE%B2-%E6%AD%A3%E5%88%99%E5%8C%96%E4%B8%8E%E4%BC%98%E5%8C%96/p2_hu_9ba2a5ffafec5812.jpg 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="206"
data-flex-basis="496px"
&gt;&lt;/p&gt;
&lt;h3 id="æŸå¤±å‡½æ•°çš„æ­£åˆ™åŒ–é¡¹"&gt;æŸå¤±å‡½æ•°çš„æ­£åˆ™åŒ–é¡¹
&lt;/h3&gt;$$
L(W) = \frac{1}{N} \sum_{i=1}^{N} L_i(f(x_i, W), y_i) + \lambda R(W)\tag{6}
$$&lt;p&gt;å®ƒçš„ä½œç”¨æ˜¯é˜²æ­¢æ¨¡å‹åœ¨è®­ç»ƒæ•°æ®ä¸Šè¡¨ç°è¿‡å¥½ï¼Œå› æ­¤æ­£åˆ™åŒ–çš„ç›®çš„å°±æ˜¯è®©å®ƒåœ¨è®­ç»ƒæ•°æ®è¡¨ç°æ›´å·®ï¼Œåœ¨æµ‹è¯•é›†è¡¨ç°æ›´å¥½ï¼Œå…³äºè¿™é‡Œçš„$\lambda$ï¼Œè¿™æ˜¯æ­£åˆ™åŒ–å¼ºåº¦ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ä¸ªè¶…å‚æ•°ï¼Œè¿™ä¸ªå‚æ•°ç”¨äºæ§åˆ¶æ¨¡å‹å¯¹è®­ç»ƒæ•°æ®çš„æ‹Ÿåˆç¨‹åº¦&lt;/p&gt;
&lt;p&gt;&lt;img src="https://lunatide.tech/p/cs231-%E7%AC%AC%E4%B8%89%E8%AE%B2-%E6%AD%A3%E5%88%99%E5%8C%96%E4%B8%8E%E4%BC%98%E5%8C%96/p1.jpg"
width="1842"
height="904"
srcset="https://lunatide.tech/p/cs231-%E7%AC%AC%E4%B8%89%E8%AE%B2-%E6%AD%A3%E5%88%99%E5%8C%96%E4%B8%8E%E4%BC%98%E5%8C%96/p1_hu_55cab8e754a1c1e5.jpg 480w, https://lunatide.tech/p/cs231-%E7%AC%AC%E4%B8%89%E8%AE%B2-%E6%AD%A3%E5%88%99%E5%8C%96%E4%B8%8E%E4%BC%98%E5%8C%96/p1_hu_8bcddbc1a104a263.jpg 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="203"
data-flex-basis="489px"
&gt;&lt;/p&gt;
&lt;p&gt;ä¸Šå›¾æ˜¯ä¸€ä¸ªä¾‹å­ï¼Œç›®æ ‡æ˜¯æ‹Ÿåˆè¿™äº›æ•°æ®ç‚¹ï¼Œæœ‰f1å’Œf2ä¸¤ç§æ¨¡å‹ï¼Œf1ç©¿è¿‡äº†æ‰€æœ‰æ•°æ®ç‚¹ï¼Œæ‰€ä»¥è®­ç»ƒæˆ–æ•°æ®æŸå¤±ä¼šå¾ˆä½ï¼Œå› ä¸ºå‡ ä¹å®Œç¾æ‹Ÿåˆï¼Œä½†æ˜¯åœ¨æµ‹è¯•æ–°æ•°æ®ä¸Šï¼Œf2å¯èƒ½è¡¨ç°æ›´å¥½ï¼Œå› æ­¤ä¸è¦è¿‡åº¦æ‹Ÿåˆæ•°æ®ï¼Œè¶Šç®€å•çš„æ¨¡å‹å¯èƒ½æ•ˆæœæ›´å¥½&lt;/p&gt;
&lt;p&gt;æ¯”è¾ƒå¸¸è§çš„æ­£åˆ™åŒ–é¡¹å¦‚ä¸‹&lt;/p&gt;
&lt;p&gt;&lt;img src="https://lunatide.tech/p/cs231-%E7%AC%AC%E4%B8%89%E8%AE%B2-%E6%AD%A3%E5%88%99%E5%8C%96%E4%B8%8E%E4%BC%98%E5%8C%96/p3.jpg"
width="1046"
height="310"
srcset="https://lunatide.tech/p/cs231-%E7%AC%AC%E4%B8%89%E8%AE%B2-%E6%AD%A3%E5%88%99%E5%8C%96%E4%B8%8E%E4%BC%98%E5%8C%96/p3_hu_32c49cc527502d09.jpg 480w, https://lunatide.tech/p/cs231-%E7%AC%AC%E4%B8%89%E8%AE%B2-%E6%AD%A3%E5%88%99%E5%8C%96%E4%B8%8E%E4%BC%98%E5%8C%96/p3_hu_2a975fc0be51e0c3.jpg 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="337"
data-flex-basis="809px"
&gt;&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦å¯¹æ¨¡å‹æ­£åˆ™åŒ–ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;å®ƒå…è®¸æˆ‘ä»¬å¯¹äºæƒé‡è¡¨è¾¾æŸç§åå¥½&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è®©æ¨¡å‹æ›´ç®€å•ä»è€Œåœ¨æµ‹è¯•æ•°æ®ä¸Šè¡¨ç°æ›´å¥½&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;é€šè¿‡å¢åŠ æ›²ç‡æ”¹è¿›ä¼˜åŒ–&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="ä¼˜åŒ–"&gt;ä¼˜åŒ–
&lt;/h2&gt;&lt;h3 id="æ¢¯åº¦ä¸‹é™"&gt;æ¢¯åº¦ä¸‹é™
&lt;/h3&gt;&lt;p&gt;è¿™ä¸ªæˆ‘ä»¬éå¸¸ç†Ÿæ‚‰äº†ï¼Œåªè¦è·Ÿéšæ¢¯åº¦ï¼Œæ‰€ä»¥è®¡ç®—æ¢¯åº¦å°±å¯ä»¥äº†
&lt;/p&gt;
$$
\nabla_W L = \frac{1}{N} \sum_{i=1}^{N} \nabla_W L_i(f(x_i, W), y_i) + \lambda \nabla_W R(W)\tag{7}
$$&lt;h3 id="éšæœºæ¢¯åº¦ä¸‹é™sgd"&gt;éšæœºæ¢¯åº¦ä¸‹é™(SGD)
&lt;/h3&gt;&lt;p&gt;æˆ‘ä»¬ä¹‹å‰è¯´è¿‡å¯ä»¥é€šè¿‡éå†æ•´ä¸ªè®­ç»ƒé›†ï¼Œå¯¹æ¯ä¸ªiè®¡ç®—æŸå¤±$L_i$å¹¶ä¸”æ±‡æ€»æ•´ä¸ªè®­ç»ƒé›†ï¼Œä½†æ˜¯è¿™æ ·è®¡ç®—é‡å¤ªå¤§ï¼ŒSGDçš„æ ¸å¿ƒæ˜¯æŸ¥çœ‹ä¸€ä¸ªå­é›†ä»£æ›¿æ•´ä¸ªè®­ç»ƒé›†ï¼Œæ¯æ¬¡ç§°ä¸ºä¸€ä¸ªå°æ‰¹é‡æˆ–è€…ä¸€æ‰¹æ•°æ®&lt;/p&gt;
&lt;p&gt;&lt;img src="https://lunatide.tech/p/cs231-%E7%AC%AC%E4%B8%89%E8%AE%B2-%E6%AD%A3%E5%88%99%E5%8C%96%E4%B8%8E%E4%BC%98%E5%8C%96/p5.jpg"
width="1376"
height="668"
srcset="https://lunatide.tech/p/cs231-%E7%AC%AC%E4%B8%89%E8%AE%B2-%E6%AD%A3%E5%88%99%E5%8C%96%E4%B8%8E%E4%BC%98%E5%8C%96/p5_hu_ef70d830b253656f.jpg 480w, https://lunatide.tech/p/cs231-%E7%AC%AC%E4%B8%89%E8%AE%B2-%E6%AD%A3%E5%88%99%E5%8C%96%E4%B8%8E%E4%BC%98%E5%8C%96/p5_hu_a1575809f7639b7c.jpg 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="205"
data-flex-basis="494px"
&gt;&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯æˆ‘ä»¬ä¼šé‡åˆ°ä¸€äº›é—®é¢˜ï¼Œå½“åœ¨éç‚¹æˆ–è€…å±€éƒ¨æœ€ä¼˜ç‚¹çš„æ—¶å€™ï¼Œç›´è§‚ç‚¹å¦‚ä¸‹å›¾&lt;/p&gt;
&lt;p&gt;&lt;img src="https://lunatide.tech/p/cs231-%E7%AC%AC%E4%B8%89%E8%AE%B2-%E6%AD%A3%E5%88%99%E5%8C%96%E4%B8%8E%E4%BC%98%E5%8C%96/p6.jpg"
width="1008"
height="328"
srcset="https://lunatide.tech/p/cs231-%E7%AC%AC%E4%B8%89%E8%AE%B2-%E6%AD%A3%E5%88%99%E5%8C%96%E4%B8%8E%E4%BC%98%E5%8C%96/p6_hu_ae7414dbf6328f5a.jpg 480w, https://lunatide.tech/p/cs231-%E7%AC%AC%E4%B8%89%E8%AE%B2-%E6%AD%A3%E5%88%99%E5%8C%96%E4%B8%8E%E4%BC%98%E5%8C%96/p6_hu_67761647cb59075a.jpg 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="307"
data-flex-basis="737px"
&gt;&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬å°±å¼•å…¥äº†åŠ¨é‡ï¼Œä½ å¯ä»¥ç”¨é«˜ä¸­ç‰©ç†å­¦è¿‡çš„çŸ¥è¯†æƒ³è±¡ä¸€ä¸‹ï¼ŒåŠ¨ä¸äº†äº†ç»™ä¸ªåŠ¨é‡ä»–å°±èƒ½æœç€é¢„æœŸæ–¹å‘ç»§ç»­å‰è¡Œ&lt;/p&gt;
&lt;p&gt;&lt;img src="https://lunatide.tech/p/cs231-%E7%AC%AC%E4%B8%89%E8%AE%B2-%E6%AD%A3%E5%88%99%E5%8C%96%E4%B8%8E%E4%BC%98%E5%8C%96/p7.jpg"
width="1858"
height="870"
srcset="https://lunatide.tech/p/cs231-%E7%AC%AC%E4%B8%89%E8%AE%B2-%E6%AD%A3%E5%88%99%E5%8C%96%E4%B8%8E%E4%BC%98%E5%8C%96/p7_hu_19d79852d73627b4.jpg 480w, https://lunatide.tech/p/cs231-%E7%AC%AC%E4%B8%89%E8%AE%B2-%E6%AD%A3%E5%88%99%E5%8C%96%E4%B8%8E%E4%BC%98%E5%8C%96/p7_hu_282ce9e2e7dc1f5b.jpg 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="213"
data-flex-basis="512px"
&gt;&lt;/p&gt;
&lt;h3 id="rmspropä¼˜åŒ–å™¨"&gt;RMSPropä¼˜åŒ–å™¨
&lt;/h3&gt;&lt;p&gt;åœ¨æ¢¯åº¦ä¸‹é™ä¸­ï¼Œå¾ˆå®¹æ˜“å‡ºç°å‚æ•°æ›´æ–°ä¸ç¨³å®šï¼Œä¹Ÿå°±æ˜¯æŒ¯è¡å¾ˆå¤§çš„æƒ…å†µï¼ŒRMSPropå°±æ˜¯æ”¹è¿›äº†è¿™ä¸ªé—®é¢˜ï¼Œç»´æŠ¤äº†ä¸€ä¸ªæ¢¯åº¦å¹³æ–¹çš„â€œæŒ‡æ•°åŠ æƒç§»åŠ¨å¹³å‡â€ï¼Œè¯´çš„ç›´ç™½ç‚¹ï¼Œå®ƒå¯ä»¥è‡ªé€‚åº”å­¦ä¹ ç‡ï¼Œåœ¨å‰§çƒˆå˜åŒ–çš„æ–¹å‘é™ä½å­¦ä¹ ç‡&lt;/p&gt;
&lt;h3 id="adamä¼˜åŒ–å™¨"&gt;Adamä¼˜åŒ–å™¨
&lt;/h3&gt;&lt;p&gt;Adamä¼˜åŒ–å™¨æ˜¯ç°åœ¨æœ€æµè¡Œçš„ï¼Œå®ƒå®é™…ä¸Šæ˜¯å¸¦åŠ¨é‡åŠ¨é‡çš„RMSProp&lt;/p&gt;
&lt;p&gt;&lt;img src="https://lunatide.tech/p/cs231-%E7%AC%AC%E4%B8%89%E8%AE%B2-%E6%AD%A3%E5%88%99%E5%8C%96%E4%B8%8E%E4%BC%98%E5%8C%96/p8.jpg"
width="1896"
height="884"
srcset="https://lunatide.tech/p/cs231-%E7%AC%AC%E4%B8%89%E8%AE%B2-%E6%AD%A3%E5%88%99%E5%8C%96%E4%B8%8E%E4%BC%98%E5%8C%96/p8_hu_5d91a89f81abd08.jpg 480w, https://lunatide.tech/p/cs231-%E7%AC%AC%E4%B8%89%E8%AE%B2-%E6%AD%A3%E5%88%99%E5%8C%96%E4%B8%8E%E4%BC%98%E5%8C%96/p8_hu_eca66d8ce6e12881.jpg 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="214"
data-flex-basis="514px"
&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;first_moment&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="c1"&gt;# ä¸€é˜¶çŸ©åˆå§‹åŒ–&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;second_moment&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="c1"&gt;# äºŒé˜¶çŸ©åˆå§‹åŒ–ä¸º&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;num_iterations&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;dx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;compute_gradient&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# å½“å‰å‚æ•° x çš„æ¢¯åº¦&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;first_moment&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;beta1&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;first_moment&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;beta1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;dx&lt;/span&gt; &lt;span class="c1"&gt;# åŠ¨é‡ï¼Œå¯¹æ¢¯åº¦åšæŒ‡æ•°å¹³å‡è®©æ¢¯åº¦æ›´å¹³æ»‘&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;second_moment&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;beta2&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;second_moment&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;beta2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;dx&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;dx&lt;/span&gt; &lt;span class="c1"&gt;# RMSProp&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# å› ä¸º m_0=0ï¼Œæ‰€ä»¥å‰å‡ æ­¥çš„ m_t åå°ï¼Œç”¨ 1 - Î²1^t ä¿®æ­£&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;first_unbias&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;first_moment&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;beta1&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;second_unbias&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;second_moment&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;beta2&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;-=&lt;/span&gt; &lt;span class="n"&gt;learning_rate&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;first_unbias&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;second_unbias&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description></item><item><title>CS231 ç¬¬äºŒè®² å›¾åƒåˆ†ç±»</title><link>https://lunatide.tech/p/cs231-%E7%AC%AC%E4%BA%8C%E8%AE%B2-%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB/</link><pubDate>Tue, 25 Nov 2025 00:00:00 +0000</pubDate><guid>https://lunatide.tech/p/cs231-%E7%AC%AC%E4%BA%8C%E8%AE%B2-%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB/</guid><description>&lt;img src="https://lunatide.tech/p/cs231-%E7%AC%AC%E4%BA%8C%E8%AE%B2-%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB/pic1.jpg" alt="Featured image of post CS231 ç¬¬äºŒè®² å›¾åƒåˆ†ç±»" /&gt;&lt;p&gt;å¼€å§‹å­¦cs231näº†ï¼ŒæœŸæœ›æ˜¯ä¸€å‘¨3-4èŠ‚ï¼Œå°½é‡4å‘¨å®Œæˆæ‰&lt;/p&gt;
&lt;p&gt;è¯¾ç¨‹ä¸»é¡µ:https://cs231n.stanford.edu/&lt;/p&gt;
&lt;p&gt;ä½œä¸š:https://cs231n.stanford.edu/schedule.html&lt;/p&gt;
&lt;h2 id="å›¾åƒåˆ†ç±»"&gt;å›¾åƒåˆ†ç±»
&lt;/h2&gt;&lt;p&gt;å›¾åƒé€šå¸¸ç”±æ•°æ®çŸ©é˜µå®šä¹‰ï¼Œæ›´ä¸€èˆ¬åœ°è¯´æ˜¯æ•°æ®å¼ é‡ï¼Œè¯†åˆ«å›¾åƒå¯¹äºæœºå™¨æ¥è¯´æ˜¯ä¸ªå¾ˆå¤§çš„æŒ‘æˆ˜ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œäººç±»ä¸ç®¡ä»ä»€ä¹ˆè§’åº¦çœ‹ä¸€ä¸ªç‰©ä½“ä»–éƒ½æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯å½“ä¸€ä¸ªæ‘„åƒæœºå¯¹å‡†ä¸€ä¸ªç‰©ä½“å¹¶è½¬åŠ¨ï¼Œåƒç´ å€¼å®æ—¶éƒ½åœ¨æ”¹å˜ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œå…‰ç…§ï¼Œç‰©ä½“é®æŒ¡ç­‰ç­‰å¯¹äºå›¾åƒçš„è¯†åˆ«æ¥è¯´éƒ½æ˜¯æŒ‘æˆ˜&lt;/p&gt;
&lt;p&gt;æœºå™¨å­¦ä¹ é‡‡ç”¨äº†æ•°æ®é©±åŠ¨çš„æ–¹æ³•ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ”¶é›†å›¾åƒåŠå…¶æ ‡ç­¾çš„æ•°æ®é›†&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨æœºå™¨å­¦ä¹ ç®—æ³•è®­ç»ƒåˆ†ç±»å™¨&lt;/li&gt;
&lt;li&gt;åœ¨æ–°å›¾åƒä¸Šè¯„ä¼°åˆ†ç±»å™¨&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸‹é¢æ˜¯åˆ†åˆ«å¯¹åº”æ­¥éª¤2å’Œ3çš„æ¥å£&lt;/p&gt;
&lt;p&gt;&lt;img src="https://lunatide.tech/p/cs231-%E7%AC%AC%E4%BA%8C%E8%AE%B2-%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB/p1.jpg"
width="1854"
height="880"
srcset="https://lunatide.tech/p/cs231-%E7%AC%AC%E4%BA%8C%E8%AE%B2-%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB/p1_hu_db114bed21d40de6.jpg 480w, https://lunatide.tech/p/cs231-%E7%AC%AC%E4%BA%8C%E8%AE%B2-%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB/p1_hu_1fd9fab2ea483ffb.jpg 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="210"
data-flex-basis="505px"
&gt;&lt;/p&gt;
&lt;h3 id="nearest-neighbor-classifier"&gt;Nearest Neighbor Classifier
&lt;/h3&gt;&lt;p&gt;è®¾å®šä¸€ä¸ªè·ç¦»å‡½æ•°ï¼Œå¯¹äºä¸€å¯¹å›¾åƒï¼ˆquery dataå’Œtraining dataï¼‰ï¼Œè¿”å›ä¸€ä¸ªå®šä¹‰ä¸¤è€…ç›¸ä¼¼åº¦çš„å€¼&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æ˜¯ä¸¤ç§å¸¸è§çš„è®¡ç®—è·ç¦»çš„æ–¹å¼&lt;/p&gt;
&lt;p&gt;é¦–å…ˆæ˜¯L1è·ç¦»ï¼Œå®šä¹‰ä¸ºä¸¤ä¸ªå›¾åƒæ‰€æœ‰åƒç´ å·®ç»å¯¹å€¼çš„æ€»å’Œ&lt;/p&gt;
&lt;p&gt;&lt;img src="https://lunatide.tech/p/cs231-%E7%AC%AC%E4%BA%8C%E8%AE%B2-%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB/p2.jpg"
width="1894"
height="938"
srcset="https://lunatide.tech/p/cs231-%E7%AC%AC%E4%BA%8C%E8%AE%B2-%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB/p2_hu_8bdcec047dce1abb.jpg 480w, https://lunatide.tech/p/cs231-%E7%AC%AC%E4%BA%8C%E8%AE%B2-%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB/p2_hu_ad9f3b36dca704b6.jpg 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="201"
data-flex-basis="484px"
&gt;&lt;/p&gt;
&lt;p&gt;ä¸è¿‡æˆ‘ä»¬ä¸éš¾å‘ç°ï¼Œè®­ç»ƒå‡½æ•°æ˜¯$O(1)$çš„ï¼Œè€Œé¢„æµ‹å‡½æ•°æ˜¯$O(n)$çš„ï¼Œè¿™å¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„&lt;/p&gt;
&lt;p&gt;å› æ­¤æˆ‘ä»¬æŠŠNearest Neighborè‡ªç„¶æ¨å¹¿åˆ°k-Nearest Neighborï¼Œkå€¼è¯¥å¦‚ä½•é€‰æ‹©æ‰æ¯”è¾ƒåˆé€‚ï¼Œä»¥åŠè·ç¦»å‡½æ•°è¯¥å¦‚ä½•é€‰æ‹©ï¼Œè¿™ä¸¤ä¸ªé‡å°±è¢«ç§°ä½œè¶…å‚æ•°ï¼Œä¹Ÿå°±æ˜¯éœ€è¦å†³ç­–çš„å˜é‡Ruhrè®¾ç½®è¶…å‚æ•°æœ‰å¾ˆå¤šåŠæ³•ï¼Œç¬¬ä¸€ç§æ–¹æ³•æ˜¯æŠŠéƒ¨åˆ†è®­ç»ƒæ•°æ®ä½œä¸ºéªŒè¯é›†ï¼Œåœ¨è®­ç»ƒé›†ä¸Šè®­ç»ƒæ¨¡å‹ï¼Œç„¶åé€šè¿‡éªŒè¯é›†çš„æ•ˆæœæ¥é€‰æ‹©è¶…å‚æ•°ï¼Œç„¶åç”¨è¶…å‚æ•°å¯¹æµ‹è¯•é›†è¿›è¡Œç»“æœå¤ç°ï¼Œå¹¶åœ¨æµ‹è¯•é›†éªŒè¯&lt;/p&gt;
&lt;p&gt;&lt;img src="https://lunatide.tech/p/cs231-%E7%AC%AC%E4%BA%8C%E8%AE%B2-%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB/p3.jpg"
width="1760"
height="254"
srcset="https://lunatide.tech/p/cs231-%E7%AC%AC%E4%BA%8C%E8%AE%B2-%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB/p3_hu_296eaae459bffce4.jpg 480w, https://lunatide.tech/p/cs231-%E7%AC%AC%E4%BA%8C%E8%AE%B2-%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB/p3_hu_e6ec198a01161233.jpg 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="692"
data-flex-basis="1662px"
&gt;&lt;/p&gt;
&lt;p&gt;æ›´å¥½çš„æ–¹æ³•æ˜¯ç”¨äº¤å‰éªŒè¯è®¾ç½®è¶…å‚æ•°ï¼ŒæŠŠè®­ç»ƒæ•°æ®åˆ†æˆè‹¥å¹²åˆ†åŒºï¼Œç„¶åæ¯ä¸ªåˆ†åŒºè½®æµä½œä¸ºéªŒè¯é›†ï¼Œåœ¨ä¸€ç»„æ•°æ®ä¸Šè®­ç»ƒæ•°æ®ç„¶åå†ä¸‹ä¸€ç»„æ•°æ®è¯„ä¼°æ¨¡å‹ï¼Œè¿­ä»£ï¼Œæœ€åå–ç»“æœçš„è¯„ä¼°å€¼ä½œä¸ºç»“æœ&lt;/p&gt;
&lt;p&gt;&lt;img src="https://lunatide.tech/p/cs231-%E7%AC%AC%E4%BA%8C%E8%AE%B2-%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB/p4.jpg"
width="1880"
height="952"
srcset="https://lunatide.tech/p/cs231-%E7%AC%AC%E4%BA%8C%E8%AE%B2-%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB/p4_hu_41b75f3f19c1e856.jpg 480w, https://lunatide.tech/p/cs231-%E7%AC%AC%E4%BA%8C%E8%AE%B2-%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB/p4_hu_8b2248be979a2f22.jpg 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="197"
data-flex-basis="473px"
&gt;&lt;/p&gt;
&lt;p&gt;åœ¨å®é™…ä¸­ï¼Œk Nearest Neighborä»æ¥ä¸ç”¨ï¼Œé¦–å…ˆå› ä¸ºæ•ˆç‡å¤ªä½ï¼Œå…¶æ¬¡å®ƒçš„è·ç¦»æ˜¯æŒ‰ç…§æ¯ä¸ªåƒç´ ç‚¹ä¹‹é—´æ¥è®¡ç®—çš„ï¼Œå› æ­¤å¾ˆå®¹æ˜“è¯†åˆ«é”™è¯¯ï¼Œä¾‹å¦‚æŠŠé¢œè‰²ç›¸è¿‘çš„çŒ«è¯†åˆ«æˆè€è™ï¼Œäº¦æˆ–è€…å½“æœ‰ç‰©ä½“é®æŒ¡çš„æ—¶å€™ï¼Œä½ å»è®¡ç®—ä»–çš„L2è·ç¦»æ˜¯ç›¸ç­‰çš„ï¼Œä½†æ˜¯å®é™…ä¸Šå·®åˆ«å´å¾ˆå¤§ï¼Œæœ€åï¼Œå½“æ•°æ®çš„ç»´åº¦å¾ˆå¤§çš„æ—¶å€™ï¼Œè®¡ç®—ä¼šéå¸¸çš„æ…¢&lt;/p&gt;
&lt;h3 id="çº¿æ€§åˆ†ç±»å™¨"&gt;çº¿æ€§åˆ†ç±»å™¨
&lt;/h3&gt;&lt;p&gt;&lt;img src="https://lunatide.tech/p/cs231-%E7%AC%AC%E4%BA%8C%E8%AE%B2-%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB/p5.jpg"
width="1814"
height="930"
srcset="https://lunatide.tech/p/cs231-%E7%AC%AC%E4%BA%8C%E8%AE%B2-%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB/p5_hu_1d7691d876903011.jpg 480w, https://lunatide.tech/p/cs231-%E7%AC%AC%E4%BA%8C%E8%AE%B2-%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB/p5_hu_862134743f60420.jpg 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="195"
data-flex-basis="468px"
&gt;&lt;/p&gt;
&lt;p&gt;çº¿æ€§åˆ†ç±»å™¨å°±æ˜¯ç»™å®šä¸€å¼ å›¾ç‰‡ï¼Œè½¬æ¢æˆå‘é‡ç„¶åè®¡ç®—
&lt;/p&gt;
$$
f(x,W)=Wx + b\tag{1}
$$&lt;p&gt;
è¿™é‡Œè¾“å‡ºç»“æœæ˜¯10ç»´å‘é‡ï¼Œç„¶åæ ¹æ®åˆ†é‡å†³å®šå›¾ç‰‡å±äºå“ªä¸€ç±»&lt;/p&gt;
&lt;p&gt;&lt;img src="https://lunatide.tech/p/cs231-%E7%AC%AC%E4%BA%8C%E8%AE%B2-%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB/p6.jpg"
width="1846"
height="918"
srcset="https://lunatide.tech/p/cs231-%E7%AC%AC%E4%BA%8C%E8%AE%B2-%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB/p6_hu_1ee996b2f6c2245.jpg 480w, https://lunatide.tech/p/cs231-%E7%AC%AC%E4%BA%8C%E8%AE%B2-%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB/p6_hu_a848122553dae92d.jpg 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="201"
data-flex-basis="482px"
&gt;&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯çº¿æ€§åˆ†ç±»å™¨å¹¶ä¸æ˜¯æ‰€æœ‰ä¸œè¥¿éƒ½èƒ½è§£å†³ï¼ˆå°±æ¯”å¦‚ä¸Šå›¾ï¼Œæ ¹æ®ç»“æœå›¾ç‰‡æ˜¯ç‹—ï¼ŒğŸ˜“ï¼‰ï¼Œå¯¹äºæ— æ³•åˆ†ç±»å¤§é‡åˆ†ç¦»çš„æ•°æ®å®ä¾‹å°±æ— æ³•è§£å†³&lt;/p&gt;</description></item><item><title>é±¼ä¹¦ç¬”è®°-ä¸å­¦ä¹ ç›¸å…³çš„æŠ€å·§</title><link>https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E4%B8%8E%E5%AD%A6%E4%B9%A0%E7%9B%B8%E5%85%B3%E7%9A%84%E6%8A%80%E5%B7%A7/</link><pubDate>Tue, 25 Nov 2025 00:00:00 +0000</pubDate><guid>https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E4%B8%8E%E5%AD%A6%E4%B9%A0%E7%9B%B8%E5%85%B3%E7%9A%84%E6%8A%80%E5%B7%A7/</guid><description>&lt;img src="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E4%B8%8E%E5%AD%A6%E4%B9%A0%E7%9B%B8%E5%85%B3%E7%9A%84%E6%8A%80%E5%B7%A7/pic3.jpg" alt="Featured image of post é±¼ä¹¦ç¬”è®°-ä¸å­¦ä¹ ç›¸å…³çš„æŠ€å·§" /&gt;&lt;h2 id="å‚æ•°çš„æ›´æ–°"&gt;å‚æ•°çš„æ›´æ–°
&lt;/h2&gt;</description></item><item><title>é±¼ä¹¦ç¬”è®°-è¯¯å·®åå‘ä¼ æ’­æ³•</title><link>https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E8%AF%AF%E5%B7%AE%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E6%B3%95/</link><pubDate>Sat, 22 Nov 2025 00:00:00 +0000</pubDate><guid>https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E8%AF%AF%E5%B7%AE%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E6%B3%95/</guid><description>&lt;img src="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E8%AF%AF%E5%B7%AE%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E6%B3%95/pic3.jpg" alt="Featured image of post é±¼ä¹¦ç¬”è®°-è¯¯å·®åå‘ä¼ æ’­æ³•" /&gt;&lt;h2 id="è®¡ç®—å›¾"&gt;è®¡ç®—å›¾
&lt;/h2&gt;&lt;h3 id="ç”¨è®¡ç®—å›¾æ±‚è§£"&gt;ç”¨è®¡ç®—å›¾æ±‚è§£
&lt;/h3&gt;&lt;p&gt;æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸ªç®€å•çš„é—®é¢˜&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;é—®é¢˜&lt;/strong&gt;ï¼šå¤ªéƒåœ¨è¶…å¸‚ä¹°äº†2ä¸ª100æ—¥å…ƒä¸€ä¸ªçš„è‹¹æœï¼Œæ¶ˆè´¹ç¨æ˜¯10%ï¼Œè¯·è®¡ç®—æ”¯ä»˜é‡‘é¢&lt;/p&gt;
&lt;p&gt;å¦‚ä½•ç”¨è®¡ç®—å›¾è¡¨ç¤ºï¼Œè¿™ä¸ªéå¸¸ç®€å•ï¼Œå°å­¦ç”Ÿéƒ½èƒ½çœ‹æ‡‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E8%AF%AF%E5%B7%AE%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E6%B3%95/p1.jpg"
width="1124"
height="170"
srcset="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E8%AF%AF%E5%B7%AE%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E6%B3%95/p1_hu_61f73d26853d3fd1.jpg 480w, https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E8%AF%AF%E5%B7%AE%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E6%B3%95/p1_hu_5d82d8028ee74402.jpg 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="661"
data-flex-basis="1586px"
&gt;&lt;/p&gt;
&lt;p&gt;æˆ–è€…ä¹Ÿå¯ä»¥æŠŠè¿ç®—çš„æ•°å­—æ”¾åœ¨åœ†åœˆå¤–é¢ï¼Œå¦‚ä¸‹å›¾&lt;/p&gt;
&lt;p&gt;&lt;img src="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E8%AF%AF%E5%B7%AE%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E6%B3%95/p2.jpg"
width="1106"
height="364"
srcset="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E8%AF%AF%E5%B7%AE%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E6%B3%95/p2_hu_38d7afa7e70f3904.jpg 480w, https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E8%AF%AF%E5%B7%AE%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E6%B3%95/p2_hu_a1e76eb9ace9e109.jpg 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="303"
data-flex-basis="729px"
&gt;&lt;/p&gt;
&lt;p&gt;ä¸Šé¢è¯´çš„è¿™ç§ä¾¿æ˜¯æ­£å‘ä¼ æ’­è¿ç®—ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„æ­£å¸¸è¿ç®—çš„é€»è¾‘ï¼Œä½†æ˜¯è¿™ç« çš„ä¸»é¢˜æ˜¯åå‘ä¼ æ’­ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹è¿™æ˜¯ä»€ä¹ˆ&lt;/p&gt;
&lt;h2 id="åå‘ä¼ æ’­"&gt;åå‘ä¼ æ’­
&lt;/h2&gt;&lt;h3 id="åŠ æ³•èŠ‚ç‚¹çš„åå‘ä¼ æ’­"&gt;åŠ æ³•èŠ‚ç‚¹çš„åå‘ä¼ æ’­
&lt;/h3&gt;&lt;p&gt;ä»¥z=x+yä¸ºä¾‹ï¼Œå·¦å›¾ä¸ºæ­£å‘ä¼ æ’­ï¼Œå³å›¾ä¸ºåå‘ä¼ æ’­&lt;/p&gt;
&lt;p&gt;&lt;img src="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E8%AF%AF%E5%B7%AE%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E6%B3%95/p4.jpg"
width="1102"
height="470"
srcset="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E8%AF%AF%E5%B7%AE%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E6%B3%95/p4_hu_5a5389873daf4cdc.jpg 480w, https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E8%AF%AF%E5%B7%AE%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E6%B3%95/p4_hu_4d6af2ad2f75ddb.jpg 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="234"
data-flex-basis="562px"
&gt;&lt;/p&gt;
&lt;h3 id="ä¹˜æ³•èŠ‚ç‚¹çš„åå‘ä¼ æ’­"&gt;ä¹˜æ³•èŠ‚ç‚¹çš„åå‘ä¼ æ’­
&lt;/h3&gt;&lt;p&gt;ä»¥z=xyä¸ºä¾‹&lt;/p&gt;
&lt;p&gt;&lt;img src="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E8%AF%AF%E5%B7%AE%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E6%B3%95/p5.jpg"
width="1104"
height="464"
srcset="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E8%AF%AF%E5%B7%AE%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E6%B3%95/p5_hu_9ed824f6f0b1f7bc.jpg 480w, https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E8%AF%AF%E5%B7%AE%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E6%B3%95/p5_hu_ca344d3cffec7372.jpg 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="237"
data-flex-basis="571px"
&gt;&lt;/p&gt;
&lt;h3 id="å›åˆ°å¼€å¤´çš„ä¾‹å­"&gt;å›åˆ°å¼€å¤´çš„ä¾‹å­
&lt;/h3&gt;&lt;p&gt;æ‰€ä»¥é‡æ–°æ€è€ƒå¼€å¤´çš„é‚£ä¸ªä¹°è‹¹æœçš„ä¾‹å­ï¼Œè¦è§£çš„å°±æ˜¯è‹¹æœçš„ä»·æ ¼ï¼Œè‹¹æœçš„ä¸ªæ•°ï¼Œæ¶ˆè´¹ç¨è¿™ä¸‰ä¸ªå˜é‡ä¹‹é—´å„è‡ªå¦‚ä½•å½±å“æœ€ç»ˆæ”¯ä»˜çš„é‡‘é¢ï¼Œç›¸å½“äºæ±‚â€œæ”¯ä»˜é‡‘é¢å…³äºè‹¹æœä»·æ ¼çš„å¯¼æ•°â€ï¼Œâ€œæ”¯ä»˜é‡‘é¢å…³äºè‹¹æœä¸ªæ•°çš„å¯¼æ•°â€œï¼Œâ€æ”¯ä»˜é‡‘é¢å…³äºæ¶ˆè´¹ç¨çš„å¯¼æ•°â€ï¼Œåå‘ä¼ æ’­çš„è¿‡ç¨‹å¦‚ä¸‹å›¾&lt;/p&gt;
&lt;p&gt;&lt;img src="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E8%AF%AF%E5%B7%AE%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E6%B3%95/p7.jpg"
width="1086"
height="394"
srcset="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E8%AF%AF%E5%B7%AE%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E6%B3%95/p7_hu_42d42d02431b5888.jpg 480w, https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E8%AF%AF%E5%B7%AE%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E6%B3%95/p7_hu_f781fb5ebcf799cb.jpg 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="275"
data-flex-basis="661px"
&gt;&lt;/p&gt;
&lt;p&gt;å¦‚å›¾ï¼Œ è‹¹æœä»·æ ¼çš„å¯¼æ•°æ˜¯2.2ï¼Œè‹¹æœä¸ªæ•°çš„å¯¼æ•°æ˜¯110ï¼Œæ¶ˆè´¹ç¨çš„å¯¼æ•°æ˜¯200ï¼Œæ„æ€å°±æ˜¯ï¼Œå¦‚æœæ¶ˆè´¹ç¨å’Œè‹¹æœçš„ä»·å€¼å¢é•¿åŒæ ·çš„å€¼ï¼Œæ¶ˆè´¹ç¨å°†å¯¹æœ€ç»ˆé‡‘é¢äº§ç”Ÿ200å€å·¦å³çš„å½±å“ï¼Œè‹¹æœçš„ä»·æ ¼å°†äº§ç”Ÿ2.2å€å¤§å°çš„å½±å“ï¼ˆä¸è¿‡è¿™ä¸ªä¾‹å­åœ¨ä¸­ä¸¤è€…çš„é‡çº²ä¸åŒï¼‰&lt;/p&gt;
&lt;h2 id="ç®€å•å±‚çš„å®ç°"&gt;ç®€å•å±‚çš„å®ç°
&lt;/h2&gt;&lt;p&gt;æœ¬èŠ‚ç”¨pythonå®ç°è´­ä¹°è‹¹æœçš„ä¾‹å­&lt;/p&gt;
&lt;h3 id="ä¹˜æ³•å±‚çš„å®ç°"&gt;ä¹˜æ³•å±‚çš„å®ç°
&lt;/h3&gt;&lt;p&gt;å±‚çš„å®ç°ä¸­æœ‰ä¸¤ä¸ªå…±é€šçš„æ–¹æ³•&lt;code&gt;forwar()&lt;/code&gt;å’Œ&lt;code&gt;backward()&lt;/code&gt;ã€‚&lt;code&gt;forward()&lt;/code&gt;å¯¹åº”æ­£å‘ä¼ æ’­ï¼Œ&lt;code&gt;backward()&lt;/code&gt;å¯¹åº”åå‘ä¼ æ’­ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åæ¥å®ç°ä¹˜æ³•å±‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;MulLayer&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;forward&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;out&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;out&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;backward&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;dout&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;dx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;dout&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;dy&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;dout&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;dy&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;code&gt;__init__()&lt;/code&gt;ä¸­ä¼šåˆå§‹åŒ–å®ä¾‹å˜é‡xå’Œyï¼Œå®ƒä»¬ç”¨äºä¿å­˜æ­£å‘ä¼ æ’­æ—¶çš„è¾“å‡ºå€¼ã€‚&lt;code&gt;forward()&lt;/code&gt;æ¥æ”¶xå’Œyä¸¤ä¸ªå‚æ•°ï¼Œå°†å®ƒä»¬ç›¸ä¹˜åè¾“å‡ºã€‚&lt;code&gt;backward()&lt;/code&gt;å°†ä»ä¸Šæ¸¸ä¼ æ¥çš„å¯¼æ•°(dout)ä¹˜ä»¥æ­£å‘ä¼ æ’­çš„ç¿»è½¬å€¼ï¼Œç„¶åä¼ ç»™ä¸‹æ¸¸&lt;/p&gt;
&lt;h3 id="åŠ æ³•å±‚çš„å®ç°"&gt;åŠ æ³•å±‚çš„å®ç°
&lt;/h3&gt;&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;AddLayer&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;pass&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;forward&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;out&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;out&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;backward&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;dout&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;dx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;dout&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;dy&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;dout&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;dy&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;åŠ æ³•å±‚ä¸éœ€è¦åˆå§‹åŒ–ï¼Œå®ç°éå¸¸ç®€å•&lt;/p&gt;
&lt;h3 id="ä¾‹å­"&gt;ä¾‹å­
&lt;/h3&gt;&lt;p&gt;æ¥ä¸‹æ¥çœ‹ä¸ªå®é™…æ“ä½œçš„ä¾‹å­&lt;/p&gt;
&lt;p&gt;&lt;img src="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E8%AF%AF%E5%B7%AE%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E6%B3%95/p8.jpg"
width="1100"
height="486"
srcset="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E8%AF%AF%E5%B7%AE%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E6%B3%95/p8_hu_d91fa7b2dc1cc851.jpg 480w, https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E8%AF%AF%E5%B7%AE%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E6%B3%95/p8_hu_892a359efc705636.jpg 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="226"
data-flex-basis="543px"
&gt;&lt;/p&gt;
&lt;p&gt;ä¸Šå›¾å¯ä»¥åƒå¦‚ä¸‹ä¸€æ ·å®ç°&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;span class="lnt"&gt;20
&lt;/span&gt;&lt;span class="lnt"&gt;21
&lt;/span&gt;&lt;span class="lnt"&gt;22
&lt;/span&gt;&lt;span class="lnt"&gt;23
&lt;/span&gt;&lt;span class="lnt"&gt;24
&lt;/span&gt;&lt;span class="lnt"&gt;25
&lt;/span&gt;&lt;span class="lnt"&gt;26
&lt;/span&gt;&lt;span class="lnt"&gt;27
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;apple&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;apple_num&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;orange&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;150&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;orange_num&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;tax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;1.1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;#layer&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;mul_apple_layer&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;MulLayer&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;mul_apple_layer&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;MulLayer&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;add_apple_orange_layer&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;AddLayer&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;mul_tax_layer&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;MulLayer&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# forward&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;apple_price&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mul_apple_layer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;forward&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;apple&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;app_num&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;orange_price&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mul_orange_layer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;forward&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;orange&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;orange_num&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;all_price&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;add_apple_orange_layer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;forward&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;apple_price&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;orange_price&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;price&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mul_tax_layer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;forward&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;all&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;price&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tax&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;#backward&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;dprice&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;dall_price&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;dtax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mul_tax_layer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;backward&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dprice&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;dapple_price&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;dorange_nprice&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;add_apple_orange_layer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;backward&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dall_price&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;dorange&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;dorange_num&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mul_orange_layer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;backward&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dorange_price&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;dapple&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;dapple_num&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mul_apple_layer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;backward&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dapple_price&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;price&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dapple_num&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;dapple&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;dorange_num&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;dtax&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id="æ¿€æ´»å‡½æ•°å±‚çš„å®ç°"&gt;æ¿€æ´»å‡½æ•°å±‚çš„å®ç°
&lt;/h2&gt;&lt;h3 id="reluå±‚"&gt;ReLUå±‚
&lt;/h3&gt;&lt;p&gt;æ¿€æ´»å‡½æ•°ReLUç”±ä¸‹å¼è¡¨ç¤º
&lt;/p&gt;
$$
y = \begin{cases}
x &amp; (x&gt;0) \\
0 &amp; (x \le 0)
\end{cases}\tag{1}
$$&lt;p&gt;
é€šè¿‡å¼(1)ï¼Œå¯ä»¥æ±‚å‡ºyå…³äºxçš„å¯¼æ•°ï¼Œå¦‚ä¸‹å¼
&lt;/p&gt;
$$
\frac{\partial y}{\partial x}
= \begin{cases}
1 &amp; (x&gt;0) \\
0 &amp; (x \le 0)
\end{cases}\tag{2}
$$&lt;p&gt;
æ¥ä¸‹æ¥å®ç°ä¸€ä¸‹ReLUå±‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;ReLU&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mask&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;forward&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mask&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;out&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;out&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mask&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;backward&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;dout&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;dout&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mask&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;dx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;dout&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;dx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ReLUç”±å®ä¾‹å˜é‡maskã€‚è¿™ä¸ªå˜é‡maskæ˜¯ç”±True/Falseæ„æˆçš„NumPyæ•°ç»„ï¼Œå®ƒä¼šæŠŠæ­£å‘ä¼ æ’­æ—¶è¾“å…¥çš„xçš„å…ƒç´ ä¸­å°äºç­‰äº0çš„åœ°æ–¹ä¿å­˜ä¸ºTrueï¼Œå…¶ä»–åœ°æ–¹ï¼ˆå¤§äº0çš„å…ƒç´ ï¼‰ä¿å­˜ä¸ºFalse&lt;/p&gt;
&lt;h3 id="sigmoidå±‚"&gt;Sigmoidå±‚
&lt;/h3&gt;&lt;p&gt;æ¥ä¸‹æ¥æ¥å®ç°ä¸€ä¸‹sigmoidå‡½æ•°ï¼Œsigmoidå‡½æ•°å¦‚ä¸‹å¼æ‰€ç¤º
&lt;/p&gt;
$$
y = \frac{1}{1 + \exp(-x)}\tag{3}
$$&lt;p&gt;
ç”¨è®¡ç®—å›¾è¡¨ç¤ºä¸Šå¼ï¼Œå¦‚ä¸‹æ‰€ç¤º&lt;/p&gt;
&lt;p&gt;&lt;img src="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E8%AF%AF%E5%B7%AE%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E6%B3%95/p9.jpg"
width="1096"
height="298"
srcset="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E8%AF%AF%E5%B7%AE%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E6%B3%95/p9_hu_3f51edd3f5dc0200.jpg 480w, https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E8%AF%AF%E5%B7%AE%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E6%B3%95/p9_hu_2d91eab3129c876b.jpg 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="367"
data-flex-basis="882px"
&gt;&lt;/p&gt;
&lt;p&gt;ç„¶åæˆ‘ä»¬æ¥çœ‹ä¸‹åå‘ä¼ æ’­æ˜¯æ€ä¹ˆæ ·çš„&lt;/p&gt;
&lt;p&gt;&lt;img src="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E8%AF%AF%E5%B7%AE%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E6%B3%95/p10.jpg"
width="1110"
height="252"
srcset="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E8%AF%AF%E5%B7%AE%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E6%B3%95/p10_hu_1b45b75f03d7b6fa.jpg 480w, https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E8%AF%AF%E5%B7%AE%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E6%B3%95/p10_hu_19e09904e5f4a13a.jpg 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="440"
data-flex-basis="1057px"
&gt;&lt;/p&gt;
&lt;p&gt;ä¸Šå›¾å°±æ˜¯Sigmoidå‡½æ•°çš„åå‘ä¼ æ’­è¿‡ç¨‹ï¼Œå¦‚æœä½ çœ‹æ‡‚äº†ä¸Šé¢çš„å†…å®¹ç›¸ä¿¡è¿™ä¸ªä¸éš¾ç†è§£&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬åœ¨åå‘ä¼ è¾“çš„è¿‡ç¨‹ä¸­åªéœ€è¦ä¸“æ³¨äºå®ƒçš„è¾“å…¥å’Œè¾“å‡ºå°±å¯ä»¥ï¼Œä¸ç”¨åœ¨æ„ç¹ççš„è¿‡ç¨‹&lt;/p&gt;
&lt;p&gt;è¾“å‡ºçš„ç»“æœæ­¤å¤–ï¼Œ $\frac{\partial L}{\partial y} y^{2} \exp(-x)$ å¯ä»¥è¿›ä¸€æ­¥æ•´ç†å¦‚ä¸‹ï¼š&lt;/p&gt;
$$
\begin{aligned}
\frac{\partial L}{\partial y} y^{2} \exp(-x)
&amp;= \frac{\partial L}{\partial y} \frac{1}{(1+\exp(-x))^{2}} \exp(-x) \\
&amp;= \frac{\partial L}{\partial y} \frac{1}{1+\exp(-x)} \frac{\exp(-x)}{1+\exp(-x)} \\
&amp;= \frac{\partial L}{\partial y} \, y (1-y)
\end{aligned}\tag{4}
$$&lt;p&gt;
å®ç°ä¸€ä¸‹Sigmoidå±‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Sigmoid&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;out&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Nonoe&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;forward&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;out&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;out&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;out&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;out&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;backward&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;dout&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;dx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;dout&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;out&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;out&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;dx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id="affinesoftmaxå±‚çš„å®ç°"&gt;Affine/Softmaxå±‚çš„å®ç°
&lt;/h2&gt;&lt;h3 id="affineå±‚"&gt;Affineå±‚
&lt;/h3&gt;&lt;p&gt;ç¥ç»ç½‘ç»œçš„æ­£å‘ä¼ æ’­ä¸­ï¼Œä¸ºäº†è®¡ç®—åŠ æƒä¿¡å·çš„æ€»å’Œï¼Œä½¿ç”¨äº†çŸ©é˜µçš„ç§¯ä¹˜è¿ç®—(NumPyä¸­æ˜¯np.dot)&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç¥ç»ç½‘ç»œçš„æ­£å‘ä¼ æ’­ä¸­è¿›è¡Œçš„çŸ©é˜µçš„ä¹˜ç§¯è¿ç®—åœ¨å‡ ä½•å­¦é¢†åŸŸè¢«ç§°ä¸ºâ€œä»¿å°„å˜æ¢â€ã€‚å› æ­¤ï¼Œè¿™é‡Œå°†è¿›è¡Œä»¿å°„å˜æ¢çš„å¤„ç†å®ç°ç§°ä¸ºâ€œAffineå±‚â€&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å°†è¿™é‡Œè¿›è¡Œçš„æ±‚çŸ©é˜µçš„ä¹˜ç§¯å’Œåç½®çš„å’Œçš„è¿ç®—ç”¨è®¡ç®—å›¾è¡¨ç¤ºå‡ºæ¥ã€‚å°†ä¹˜ç§¯è¿ç®—ç”¨â€œdotâ€èŠ‚ç‚¹è¡¨ç¤ºçš„è¯ï¼Œåˆ™np.dot(X,W) + Bçš„è¿ç®—å¯ä»¥ç”¨ä¸‹å›¾çš„è®¡ç®—å›¾æ¥è¡¨ç¤ºå‡ºæ¥ï¼Œå¦å¤–ï¼Œåœ¨å„ä¸ªå˜é‡çš„ä¸Šæ–¹æ ‡è®°äº†å®ƒä»¬çš„å½¢çŠ¶&lt;/p&gt;
&lt;p&gt;&lt;img src="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E8%AF%AF%E5%B7%AE%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E6%B3%95/p11.jpg"
width="1054"
height="474"
srcset="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E8%AF%AF%E5%B7%AE%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E6%B3%95/p11_hu_fd80e1968b1c74ce.jpg 480w, https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E8%AF%AF%E5%B7%AE%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E6%B3%95/p11_hu_3b790ab1553fc989.jpg 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="222"
data-flex-basis="533px"
&gt;&lt;/p&gt;
&lt;p&gt;ä¸Šå›¾æ˜¯æ¯”è¾ƒç®€å•çš„è®¡ç®—å›¾ï¼Œä¸è¿‡è¦æ³¨æ„X,W,Bæ˜¯çŸ©é˜µ&lt;/p&gt;
&lt;p&gt;è€ƒè™‘ä¸Šå›¾çš„åå‘ä¼ æ’­ï¼Œä»¥çŸ©é˜µä¸ºå¯¹è±¡çš„åå‘ä¼ æ’­ï¼ŒæŒ‰çŸ©é˜µçš„å„ä¸ªå…ƒç´ è¿›è¡Œè®¡ç®—æ—¶ï¼Œæ­¥éª¤å’Œä»¥æ ‡é‡ä¸ºå¯¹è±¡çš„è®¡ç®—å›¾ç›¸åŒã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥å†™å‡ºè®¡ç®—å›¾çš„åå‘ä¼ æ’­ï¼Œå¦‚ä¸‹å›¾&lt;/p&gt;
&lt;p&gt;&lt;img src="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E8%AF%AF%E5%B7%AE%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E6%B3%95/p12.jpg"
width="1100"
height="604"
srcset="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E8%AF%AF%E5%B7%AE%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E6%B3%95/p12_hu_aee8fdc01ab3d9c6.jpg 480w, https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E8%AF%AF%E5%B7%AE%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E6%B3%95/p12_hu_a26e716dbecf541a.jpg 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="182"
data-flex-basis="437px"
&gt;&lt;/p&gt;
&lt;p&gt;è§‚å¯Ÿä¸€ä¸‹ä¸Šå›¾ä¸­å„ä¸ªå˜é‡çš„å½¢çŠ¶ï¼ŒXå’Œ$\frac{\partial L}{\partial \mathbf{X}}$å½¢çŠ¶ç›¸åŒï¼ŒWå’Œ$\frac{\partial L}{\partial \mathbf{W}}$ï¼Œå½¢çŠ¶ç›¸åŒï¼Œä»ä¸‹å¼å°±å¯ä»¥çœ‹å‡ºXå’Œ$\frac{\partial L}{\partial \mathbf{X}}$å½¢çŠ¶ç›¸åŒ
&lt;/p&gt;
$$
\mathbf{X} = (x_0, x_1, \cdots, x_n)\\
\frac{\partial L}{\partial \mathbf{X}}
= \left(
\frac{\partial L}{\partial x_0},
\frac{\partial L}{\partial x_1},
\cdots,
\frac{\partial L}{\partial x_n}
\right)\tag{5}
$$&lt;h3 id="æ‰¹ç‰ˆæœ¬çš„affineå±‚"&gt;æ‰¹ç‰ˆæœ¬çš„Affineå±‚
&lt;/h3&gt;&lt;p&gt;å‰é¢ä»‹ç»çš„Affineå±‚çš„è¾“å…¥Xæ˜¯ä»¥å•ä¸ªæ•°æ®ä¸ºå¯¹è±¡çš„ã€‚ç°åœ¨æˆ‘ä»¬è€ƒè™‘Nä¸ªæ•°æ®ä¸€èµ·è¿›è¡Œæ­£å‘ä¼ æ’­çš„æƒ…å†µ&lt;/p&gt;
&lt;p&gt;ä¸‹å›¾æ˜¯æ‰¹ç‰ˆæœ¬çš„affineå±‚çš„è®¡ç®—å›¾&lt;/p&gt;
&lt;p&gt;&lt;img src="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E8%AF%AF%E5%B7%AE%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E6%B3%95/p13.jpg"
width="1102"
height="648"
srcset="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E8%AF%AF%E5%B7%AE%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E6%B3%95/p13_hu_84696632d7e84b42.jpg 480w, https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E8%AF%AF%E5%B7%AE%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E6%B3%95/p13_hu_5730063b13f44eba.jpg 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="170"
data-flex-basis="408px"
&gt;&lt;/p&gt;
&lt;p&gt;ç°åœ¨è¾“å…¥Xçš„å½¢çŠ¶æ˜¯(N,2)ã€‚ä¹‹åå°±å’Œå‰é¢ä¸€æ ·&lt;/p&gt;
&lt;p&gt;æ­£å‘ä¼ æ’­æ—¶ï¼Œåç½®è¢«åŠ åˆ°$XÂ·W$çš„å„ä¸ªæ•°æ®ä¸Šã€‚æ¯”å¦‚ï¼ŒN=2æ—¶ï¼Œåç½®ä¼šåˆ†åˆ«åŠ åˆ°è¿™ä¸¤ä¸ªæ•°æ®ä¸Šï¼Œå› æ­¤åå‘ä¼ æ’­æ—¶ï¼Œå„ä¸ªæ•°æ®çš„åå‘ä¼ æ’­çš„å€¼éœ€è¦æ±‡æ€»ä¸ºåç½®çš„å…ƒç´ &lt;/p&gt;
&lt;p&gt;Affineçš„å®ç°å¦‚ä¸‹&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;span class="lnt"&gt;20
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Affine&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;W&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;W&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;W&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dW&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;delf&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;db&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;forward&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;out&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;W&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;out&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;backward&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;dout&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;dx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dout&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;W&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dW&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;dout&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;db&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dout&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;dx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id="softmax-with-losså±‚"&gt;Softmax-with-Losså±‚
&lt;/h3&gt;&lt;p&gt;&lt;img src="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E8%AF%AF%E5%B7%AE%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E6%B3%95/p14.jpg"
width="1078"
height="328"
srcset="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E8%AF%AF%E5%B7%AE%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E6%B3%95/p14_hu_556a02f015a0c413.jpg 480w, https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E8%AF%AF%E5%B7%AE%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E6%B3%95/p14_hu_2b3541fe4bb130e2.jpg 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="328"
data-flex-basis="788px"
&gt;&lt;/p&gt;
&lt;p&gt;ä¹‹å‰è¯´è¿‡softmaxå‡½æ•°ä¼šå°†è¾“å…¥å€¼æ­£è§„åŒ–ï¼ˆå°†è¾“å‡ºå€¼çš„å’Œè°ƒæ•´ä¸º1ï¼‰ç„¶åå†è¾“å‡ºã€‚å¦å¤–ï¼Œå› ä¸ºæ‰‹å†™æ•°å­—è¯†åˆ«è¦è¿›è¡Œ10ç±»åˆ†ç±»ï¼Œæ‰€ä»¥å‘Softmaxå±‚çš„è¾“å…¥ä¹Ÿæœ‰10ä¸ª&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æ¥å®ç°Softmaxå±‚ï¼Œè®¡ç®—å›¾å¦‚ä¸‹å›¾æ‰€ç¤º&lt;/p&gt;
&lt;p&gt;&lt;img src="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E8%AF%AF%E5%B7%AE%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E6%B3%95/p15.jpg"
width="1094"
height="388"
srcset="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E8%AF%AF%E5%B7%AE%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E6%B3%95/p15_hu_548a881c5c82c93.jpg 480w, https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E8%AF%AF%E5%B7%AE%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E6%B3%95/p15_hu_f99d8323d686c23c.jpg 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="281"
data-flex-basis="676px"
&gt;&lt;/p&gt;
&lt;p&gt;ä¸Šå›¾çš„è®¡ç®—å›¾å¯ä»¥ç®€åŒ–æˆä¸‹å›¾&lt;/p&gt;
&lt;p&gt;&lt;img src="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E8%AF%AF%E5%B7%AE%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E6%B3%95/p16.jpg"
width="1088"
height="696"
srcset="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E8%AF%AF%E5%B7%AE%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E6%B3%95/p16_hu_3be51e735e32ac64.jpg 480w, https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E8%AF%AF%E5%B7%AE%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E6%B3%95/p16_hu_dc18f135b24ff7a8.jpg 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="156"
data-flex-basis="375px"
&gt;&lt;/p&gt;
&lt;p&gt;ä¸Šå›¾çš„è®¡ç®—å›¾ä¸­ï¼Œsoftmaxå‡½æ•°è®°ä¸ºSoftmaxå±‚ï¼Œäº¤å‰ç†µè¯¯å·®è®°ä¸ºCross Entropy errorå±‚ã€‚è¿™é‡Œå‡è®¾è¦è¿›è¡Œä¸‰ç±»åˆ†ç±»ï¼Œä»å‰é¢çš„å±‚æ¥æ”¶ä¸‰ä¸ªè¾“å…¥ï¼ŒSoftmaxå±‚å°†è¾“å…¥(a1,a2,a3)æ­£è§„åŒ–ï¼Œè¾“å‡º(y1,y2,y3)Cross Entropy Errorå±‚æ¥æ”¶Softmaxçš„è¾“å‡º(y1,y2,y3)å’Œæ•™å¸ˆæ ‡ç­¾(t1,t2,t3)ï¼Œä»è¿™äº›æ•°æ®ä¸­è¾“å‡ºæŸå¤±L&lt;/p&gt;
&lt;p&gt;ä¸Šå›¾è¦æ³¨æ„çš„æ˜¯åå‘ä¼ æ’­çš„ç»“æœï¼ŒSoftmaxå±‚çš„åå‘ä¼ æ’­å¾—åˆ°äº†(y1-t1,y2-t2,y3-t3)è¿™æ ·æ¼‚äº®çš„ç»“æœã€‚ç”±äº(y1,y2,y3)æ˜¯Softmaxå±‚çš„è¾“å‡ºï¼Œ(t1,t2,t3)æ˜¯ç›‘ç£æ•°æ®ï¼Œæ‰€ä»¥(y1-t1,y2-t2,y3-t3)æ˜¯Softmaxå±‚çš„è¾“å‡ºå’Œæ•™å¸ˆæ ‡ç­¾çš„å·®åˆ†ã€‚ç¥ç»ç½‘ç»œä¼šæŠŠè¿™ä¸ªå·®åˆ†è¡¨ç¤ºçš„è¯¯å·®ä¼ é€’ç»™å‰é¢çš„å±‚ã€‚&lt;/p&gt;
&lt;p&gt;ç¥ç»ç½‘ç»œå­¦ä¹ çš„ç›®çš„å°±æ˜¯é€šè¿‡è°ƒæ•´æƒé‡å‚æ•°ï¼Œä½¿ç¥ç»ç½‘ç»œçš„è¾“å‡ºæ¥è¿‘æ•™å¸ˆæ ‡ç­¾ã€‚å› æ­¤ï¼Œå¿…é¡»å°†ç¥ç»ç½‘ç»œçš„è¾“å‡ºä¸æ•™å¸ˆæ ‡ç­¾çš„è¯¯å·®é«˜æ•ˆåœ°ä¼ é€’ç»™å‰é¢çš„å±‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨å®ç°ä¸€ä¸‹Softmax-with-Losså±‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;SoftmaxWithLoss&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loss&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt; &lt;span class="c1"&gt;# æŸå¤±&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt; &lt;span class="c1"&gt;# softmaxçš„è¾“å‡º&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt; &lt;span class="c1"&gt;# ç›‘ç£æ•°æ®ï¼ˆone-hot vectorï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;forward&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;softmax&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loss&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;cross_entropy_error&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loss&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;backward&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dout&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;batch_size&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;dx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;batch_size&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;dx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description></item><item><title>é±¼ä¹¦ç¬”è®°-ç¥ç»ç½‘ç»œçš„å­¦ä¹ </title><link>https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%9A%84%E5%AD%A6%E4%B9%A0/</link><pubDate>Mon, 17 Nov 2025 00:00:00 +0000</pubDate><guid>https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%9A%84%E5%AD%A6%E4%B9%A0/</guid><description>&lt;img src="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%9A%84%E5%AD%A6%E4%B9%A0/pic3.jpg" alt="Featured image of post é±¼ä¹¦ç¬”è®°-ç¥ç»ç½‘ç»œçš„å­¦ä¹ " /&gt;&lt;h2 id="ä»æ•°æ®ä¸­å­¦ä¹ "&gt;ä»æ•°æ®ä¸­å­¦ä¹ 
&lt;/h2&gt;&lt;p&gt;ç¥ç»ç½‘ç»œçš„ç‰¹å¾å°±æ˜¯ä»æ•°æ®ä¸­å­¦ä¹ ï¼ˆç”±æ•°æ®è‡ªåŠ¨å†³å®šæƒé‡å‚æ•°çš„å€¼ï¼‰&lt;/p&gt;
&lt;h3 id="æ•°æ®é©±åŠ¨"&gt;æ•°æ®é©±åŠ¨
&lt;/h3&gt;&lt;p&gt;æˆ‘ä»¬æ¥ç€ä¸Šä¸€ç« æœ€åæ‰‹å†™æ•°å­—è¯†åˆ«çš„è¯é¢˜ï¼Œæ€è€ƒä¸€ä¸‹ä¼šå‘ç°å¦‚æœè®¾è®¡ä¸€ä¸ªèƒ½è‡ªåŠ¨è¯†åˆ«5çš„ç®—æ³•è¿˜æ˜¯æŒºå›°éš¾çš„ï¼ˆè‡³å°‘æˆ‘æ˜¯è¿™æ ·è®¤ä¸ºçš„ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬åº”è¯¥è€ƒè™‘é€šè¿‡æœ‰æ•ˆåˆ©ç”¨æ•°æ®æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¸€ç§æ–¹æ¡ˆæ˜¯ä»å›¾åƒä¸­æå–ç‰¹å¾é‡ï¼Œå†ç”¨æœºå™¨å­¦ä¹ æŠ€æœ¯å­¦ä¹ è¿™äº›ç‰¹å¾é‡çš„æ¨¡å¼&lt;/p&gt;
&lt;p&gt;æœºå™¨å­¦ä¹ çš„æ–¹æ³•ä¸­ï¼Œç”±æœºå™¨ä»æ”¶é›†åˆ°çš„æ•°æ®ä¸­æ‰¾åˆ°è§„å¾‹æ€§ã€‚ä½†æ˜¯å°†å›¾åƒè½¬æ¢ä¸ºå‘é‡æ—¶ä½¿ç”¨çš„ç‰¹å¾é‡ä»æ˜¯ç”±äººè®¾è®¡çš„ï¼Œå¯¹äºä¸åŒçš„é—®é¢˜ï¼Œå¿…é¡»ä½¿ç”¨åˆé€‚çš„ç‰¹å¾é‡ï¼Œæ‰èƒ½å¾—åˆ°å¥½çš„ç»“æœ&lt;/p&gt;
&lt;p&gt;è¿˜æœ‰ä¸€ç§æ˜¯ç¥ç»ç½‘ç»œï¼ˆæ·±åº¦å­¦ä¹ ï¼‰çš„æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¸å­˜åœ¨äººä¸ºä»‹å…¥ï¼Œç¥ç»ç½‘ç»œä¼šç›´æ¥å­¦ä¹ å›¾åƒæœ¬èº«&lt;/p&gt;
&lt;h3 id="è®­ç»ƒæ•°æ®å’Œæµ‹è¯•æ•°æ®"&gt;è®­ç»ƒæ•°æ®å’Œæµ‹è¯•æ•°æ®
&lt;/h3&gt;&lt;p&gt;æœºå™¨å­¦ä¹ ä¸­æŠŠæ•°æ®åˆ†æˆè®­ç»ƒæ•°æ®å’Œæµ‹è¯•æ•°æ®ä¸¤éƒ¨åˆ†ï¼Œé¦–å…ˆç”¨è®­ç»ƒæ•°æ®è¿›è¡Œå­¦ä¹ ï¼Œå¯»æ‰¾æœ€ä¼˜çš„å‚æ•°ï¼Œç„¶åç”¨æµ‹è¯•æ•°æ®è¯„ä»·è®­ç»ƒå¾—åˆ°çš„æ¨¡å‹çš„å®é™…èƒ½åŠ›ï¼Œä¸ºäº†æ­£ç¡®è¯„ä»·æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ï¼Œå°±å¿…é¡»åˆ’åˆ†è®­ç»ƒæ•°æ®å’Œæµ‹è¯•æ•°æ®ï¼Œè®­ç»ƒæ•°æ®ä¹Ÿè¢«ç§°ä½œ&lt;strong&gt;ç›‘ç£æ•°æ®&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æ³›åŒ–èƒ½åŠ›æ˜¯æŒ‡å¤„ç†æœªè¢«è§‚å¯Ÿè¿‡çš„æ•°æ®çš„èƒ½åŠ›ã€‚æœºå™¨å­¦ä¹ çš„ç›®æ ‡å°±æ˜¯ä¸ºäº†æé«˜æ³›åŒ–èƒ½åŠ›&lt;/p&gt;
&lt;p&gt;å› æ­¤ï¼Œä»…ä»…ç”¨ä¸€ä¸ªæ•°æ®é›†å»å­¦ä¹ å’Œè¯„ä»·å‚æ•°ï¼Œæ— æ³•æ­£ç¡®è¯„ä»·ï¼Œåªç”¨æŸä¸ªæ•°æ®é›†è¿‡åº¦æ‹Ÿåˆçš„çŠ¶æ€ç§°ä¸ºè¿‡æ‹Ÿåˆ&lt;/p&gt;
&lt;h2 id="æŸå¤±å‡½æ•°"&gt;æŸå¤±å‡½æ•°
&lt;/h2&gt;&lt;p&gt;ç¥ç»ç½‘ç»œçš„å­¦ä¹ é€šè¿‡æŸä¸ªæŒ‡æ ‡æ¥è¡¨ç¤ºç°åœ¨çš„çŠ¶æ€ã€‚ç„¶åä»¥è¿™ä¸ªæŒ‡æ ‡ä¸ºåŸºå‡†ï¼Œå¯»æ‰¾æœ€ä¼˜æƒé‡å‚æ•°ã€‚è¿™ä¸ªæŒ‡æ ‡è¢«ç§°ä¸º&lt;strong&gt;æŸå¤±å‡½æ•°&lt;/strong&gt;ã€‚æŸå¤±å‡½æ•°å¯ä»¥ä½¿ç”¨ä»»æ„å‚æ•°ï¼Œä½†ä¸€èˆ¬ç”¨å‡æ–¹è¯¯å·®å’Œäº¤å‰ç†µè¯¯å·®ç­‰ã€‚&lt;/p&gt;
&lt;h3 id="å‡æ–¹è¯¯å·®"&gt;å‡æ–¹è¯¯å·®
&lt;/h3&gt;&lt;p&gt;å¦‚ä¸‹å¼
&lt;/p&gt;
$$
E = \frac{1}{2} \sum_k (y_k - t_k) ^ 2 \tag{1}
$$&lt;p&gt;
è¿™é‡Œ$y_k$æ˜¯è¡¨ç¤ºç¥ç»ç½‘ç»œçš„è¾“å‡ºï¼Œ$t_k$æ˜¯è¡¨ç¤ºç›‘ç£æ•°æ®ï¼Œ$k$è¡¨ç¤ºæ•°æ®çš„ç»´æ•°ï¼Œå¦‚å¼(1)æ‰€ç¤ºï¼Œå‡æ–¹è¯¯å·®ä¼šè®¡ç®—ç¥ç»ç½‘ç»œçš„è¾“å‡ºå’Œæ­£ç¡®è§£ç›‘ç£æ•°æ®çš„å„ä¸ªå…ƒç´ ä¹‹å·®çš„å¹³æ–¹ï¼Œå†æ±‚æ€»å’Œã€‚pythonå®ç°å‡æ–¹è¯¯å·®çš„å®ç°æ–¹å¼å¦‚ä¸‹æ‰€ç¤º&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;mean_squared_error&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id="äº¤å‰ç†µè¯¯å·®"&gt;äº¤å‰ç†µè¯¯å·®
&lt;/h3&gt;&lt;p&gt;äº¤å‰ç†µè¯¯å·®å¦‚ä¸‹å¼æ‰€ç¤º
&lt;/p&gt;
$$
E = - \sum_k (t_k \log{y_k}) \tag{2}
$$&lt;p&gt;
$y_k$æ˜¯ç¥ç»ç½‘ç»œçš„è¾“å‡ºï¼Œ$t_k$æ˜¯æ­£ç¡®è§£æ ‡ç­¾(é‡‡ç”¨one-hotè¡¨ç¤º)ã€‚äº¤å‰ç†µè¯¯å·®çš„å€¼æ˜¯ç”±æ­£ç¡®è§£æ ‡ç­¾æ‰€å¯¹åº”çš„è¾“å‡ºç»“æœå†³å®šçš„ã€‚&lt;/p&gt;
&lt;p&gt;æ ¹æ®å¯¹æ•°å‡½æ•°çš„æ€§è´¨æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œæ­£ç¡®è§£æ ‡ç­¾å¯¹åº”çš„è¾“å‡ºè¶Šå¤§ï¼Œå¼(2)çš„å€¼å°±è¶Šé è¿‘0ï¼›è¾“å‡ºä¸º1æ—¶ï¼Œäº¤å‰ç†µçš„è¯¯å·®ä¸º0ã€‚å¦‚æœæ­£ç¡®è§£æ ‡ç­¾å¯¹åº”çš„è¾“å‡ºè¾ƒå°ï¼Œ(2)çš„å€¼å°±è¶Šå¤§ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢å®ç°ä¸€ä¸‹äº¤å‰ç†µè¯¯å·®&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;cross_entropy_error&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;delta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;delta&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;yå’Œtåœ¨è¿™é‡Œæ˜¯NumPyæ•°ç»„ï¼ŒåŠ ä¸Šä¸€ä¸ªdeltaæ˜¯ä¸ºäº†é˜²æ­¢-infçš„å‘ç”Ÿ&lt;/p&gt;
&lt;h3 id="mini-batchå­¦ä¹ "&gt;mini-batchå­¦ä¹ 
&lt;/h3&gt;&lt;p&gt;å‰é¢è¯´çš„éƒ½æ˜¯å•ä¸ªæ•°æ®çš„æŸå¤±å‡½æ•°ã€‚å¦‚æœè¦æ±‚æ‰€æœ‰è®­ç»ƒæ•°æ®çš„æŸå¤±å‡½æ•°çš„æ€»å’Œï¼Œä»¥äº¤å‰ç†µè¯¯å·®ä¸ºä¾‹ï¼Œå¯ä»¥å†™æˆä¸‹é¢çš„å¼(3)
&lt;/p&gt;
$$
E = -\frac{1}{N} \sum_{n} \sum_{k} t_{nk}\,\log y_{nk} \tag{3}
$$&lt;p&gt;
å‡è®¾ä¸€å…±æœ‰Nä¸ªæ•°æ®ï¼Œ$t_{nk}$è¡¨ç¤ºç¬¬nä¸ªæ•°æ®çš„ç¬¬kä¸ªå…ƒç´ çš„å€¼&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªå¼å­å°±æ˜¯æŠŠå•ä¸ªæ•°æ®çš„æŸå¤±å‡½æ•°çš„å¼æ‰©å¤§åˆ°äº†Nä»½æ•°æ®ï¼Œä¸è¿‡æœ€åè¿˜è¦é™¤ä»¥Nè¿›è¡Œæ­£è§„åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;MNISTæ•°æ®é›†çš„è®­ç»ƒæ•°æ®æœ‰60000ä¸ªï¼Œç”¨å…¨éƒ¨æ•°æ®æ¥è®¡ç®—æŸå¤±å‡½æ•°çš„å€¼æ‰€èŠ±è´¹çš„æ—¶é—´å¤ªé•¿ï¼Œæ‰€ä»¥æˆ‘ä»¬ä»ä¸­é€‰å–ä¸€éƒ¨åˆ†ã€‚ç¥ç»ç½‘ç»œçš„å­¦ä¹ ä¹Ÿæ˜¯ä»è®­ç»ƒæ•°æ®ä¸­é€‰å‡ºä¸€æ‰¹æ•°æ®ï¼ˆç§°ä¸ºmini-batch)ï¼Œç„¶åå¯¹æ¯ä¸ªmini-batchè¿›è¡Œå­¦ä¹ ã€‚&lt;/p&gt;
&lt;h3 id="mini-batchç‰ˆäº¤å‰ç†µè¯¯å·®çš„å®ç°"&gt;mini-batchç‰ˆäº¤å‰ç†µè¯¯å·®çš„å®ç°
&lt;/h3&gt;&lt;p&gt;å¯¹äºmini-batchçš„äº¤å‰ç†µè¯¯å·®ï¼Œåªè¦æ”¹è‰¯ä¸€ä¸‹ä¹‹å‰å®ç°å¯¹åº”å•ä¸ªæ•°æ®çš„äº¤å‰ç†µè¯¯å·®å°±å¯ä»¥ã€‚è¿™é‡Œå®ç°ä¸€ä¸ªå¯ä»¥åŒæ—¶å¤„ç†å•ä¸ªæ•°æ®å’Œæ‰¹é‡æ•°æ®ä¸¤ç§æƒ…å†µçš„å‡½æ•°&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;span class="lnt"&gt;6
&lt;/span&gt;&lt;span class="lnt"&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;cross_entropy_error&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ndim&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;reshape&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;reshape&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;batch_size&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;batch_size&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;batch_size&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™é‡Œï¼Œyæ˜¯ç¥ç»ç½‘ç»œçš„è¾“å‡ºï¼Œtæ˜¯ç›‘ç£æ•°æ®ã€‚yçš„ç»´åº¦ä¸º1æ—¶ï¼Œå³æ±‚å•ä¸ªæ•°æ®çš„äº¤å‰ç†µè¯¯å·®æ—¶ï¼Œéœ€è¦æ”¹å˜æ•°æ®çš„å½¢çŠ¶ã€‚å¹¶ä¸”ï¼Œå½“è¾“å…¥ä¸ºmini-batchæ—¶ï¼Œè¦ç”¨batchçš„ä¸ªæ•°è¿›è¡Œæ­£è§„åŒ–ï¼Œè®¡ç®—å•ä¸ªæ•°æ®çš„å¹³å‡äº¤å‰ç†µè¯¯å·®&lt;/p&gt;
&lt;p&gt;æ­¤å¤–ï¼Œå½“ç›‘ç£æ•°æ®æ—¶æ ‡ç­¾å½¢å¼(éone-hotè¡¨ç¤ºï¼Œè€Œæ˜¯åƒ&amp;quot;2&amp;quot; &amp;ldquo;7&amp;quot;è¿™æ ·çš„)äº¤å‰ç†µè¯¯å·®å¯ä»¥å¦‚ä¸‹å®ç°&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;span class="lnt"&gt;6
&lt;/span&gt;&lt;span class="lnt"&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;cross_entropy_error&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ndim&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;reshape&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;reshape&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;batch_size&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;batch_size&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;batch_size&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç”±äºone-hotè¡¨ç¤ºä¸­tä¸º0çš„å…ƒç´ çš„äº¤å‰ç†µè¯¯å·®ä¹Ÿä¸º0ï¼Œå› æ­¤é’ˆå¯¹è¿™äº›å…ƒç´ çš„è®¡ç®—å¯ä»¥å¿½ç•¥ã€‚åªè¦å¯ä»¥è·å¾—ç¥ç»ç½‘ç»œåœ¨æ­£ç¡®è§£æ ‡ç­¾çš„è¾“å‡ºï¼Œå°±å¯ä»¥è®¡ç®—äº¤å‰ç†µè¯¯å·®,tä¸ºone-hotè¡¨ç¤ºæ—¶é€šè¿‡&lt;code&gt;t * np.log(y)&lt;/code&gt;è®¡ç®—çš„åœ°æ–¹tä¸ºæ ‡ç­¾å½¢å¼æ—¶ï¼Œå¯ä»¥ç”¨&lt;code&gt;np.log(y[np.arange(batch_size),t])&lt;/code&gt;è¡¨ç¤ºå®ç°ç›¸åŒçš„å¤„ç†&lt;/p&gt;
&lt;h3 id="ä¸ºä»€ä¹ˆè¦è®¾å®šæŸå¤±å‡½æ•°"&gt;ä¸ºä»€ä¹ˆè¦è®¾å®šæŸå¤±å‡½æ•°
&lt;/h3&gt;&lt;p&gt;å‡è®¾æœ‰ä¸€ä¸ªç¥ç»ç½‘ç»œï¼Œå¯¹å…¶ä¸­ä¸€ä¸ªæƒé‡å‚æ•°çš„æŸå¤±å‡½æ•°æ±‚å¯¼ï¼Œå¦‚æœè¿™ä¸ªå¯¼æ•°çš„å€¼ä¸ºè´Ÿï¼Œè¯´æ˜ä½¿è¯¥æƒé‡å‚æ•°å‘æ­£æ­£æ–¹å‘æ”¹å˜ï¼Œå¯ä»¥å‡å°æŸå¤±å‡½æ•°çš„å€¼ï¼›åä¹‹äº¦ç„¶ï¼Œä»¥åŠå½“å¯¼æ•°çš„å€¼ä¸º0æ—¶å€™ï¼Œæ— è®ºæƒé‡å‚æ•°å¾€å“ªä¸ªæ–¹å‘ï¼ŒæŸå¤±å‡½æ•°çš„å€¼éƒ½ä¸ä¼šæ”¹å˜ã€‚è€Œå¦‚æœç”¨è¯†åˆ«ç²¾åº¦ä½œä¸ºæŒ‡æ ‡ï¼Œåˆ™å‚æ•°çš„å¯¼æ•°åœ¨ç»å¤§å¤šæ•°åœ°æ–¹éƒ½ä¸º0&lt;/p&gt;
&lt;h2 id="æ¢¯åº¦æ³•"&gt;æ¢¯åº¦æ³•
&lt;/h2&gt;&lt;p&gt;æ¢¯åº¦çš„æ–¹å‘ä¸ä¸€å®šæŒ‡å‘æœ€å°å€¼ï¼Œä½†æ˜¯æ²¿ç€æ¢¯åº¦çš„æ–¹å‘èƒ½å¤Ÿæœ€å¤§é™åº¦åœ°å‡å°å‡½æ•°çš„å€¼&lt;/p&gt;
&lt;p&gt;æ¢¯åº¦æ³•æ˜¯ä»€ä¹ˆï¼Œå°±æ˜¯è®©å‡½æ•°çš„å–å€¼æ²¿ç€æ¢¯åº¦çš„æ–¹å‘å‰è¿›ä¸€æ®µè·ç¦»ï¼Œåœ¨æ–°çš„åœ°æ–¹é‡æ–°æ±‚æ¢¯åº¦ï¼Œç„¶åå†æ²¿ç€æ¢¯åº¦æ–¹å‘å‰è¿›ï¼Œåƒè¿™æ ·åå¤ï¼Œé€æ¸å‡å°å‡½æ•°å€¼ï¼Œç„¶åæˆ‘ä»¬ç”¨æ•°å­¦å¼æ¥è¡¨ç¤ºæ¢¯åº¦æ³•ï¼Œå¦‚ä¸‹å¼(4)
&lt;/p&gt;
$$
x_0 = x_0 - \eta \frac{\partial f}{\partial x_0}\\
x_1 = x_1 - \eta \frac{\partial f}{\partial x_1}\tag{4}
$$&lt;p&gt;ä¸Šå¼çš„$\eta$è¡¨ç¤ºæ›´æ–°é‡ï¼Œåœ¨ç¥ç»ç½‘ç»œçš„å­¦ä¹ ä¸­ï¼Œç§°ä¸ºå­¦ä¹ ç‡ï¼Œå†³å®šäº†åœ¨ä¸€æ¬¡å­¦ä¹ ä¸­ï¼Œåº”è¯¥å­¦ä¹ å¤šå°‘ï¼Œä»¥åŠåœ¨å¤šå¤§ç¨‹åº¦ä¸Šæ›´æ–°å‚æ•°&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥ç”¨pythonå®ç°ä¸‹æ¢¯åº¦ä¸‹é™æ³•&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;span class="lnt"&gt;6
&lt;/span&gt;&lt;span class="lnt"&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;gradient_descet&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;init_x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;lr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.01&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;step_num&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;init_x&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;step_num&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;grad&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numerical_gradient&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;-=&lt;/span&gt; &lt;span class="n"&gt;lr&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;grad&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;å‚æ•°fæ˜¯è¦è¿›è¡Œæœ€ä¼˜åŒ–çš„å‡½æ•°ï¼Œinit_xæ˜¯åˆå§‹å€¼ï¼Œlræ˜¯å­¦ä¹ ç‡ï¼Œstep_numæ˜¯æ¢¯åº¦æ³•çš„é‡å¤æ¬¡æ•°ï¼Œnumerical_gradient(f,x)ä¼šæ±‚å‡½æ•°çš„æ¢¯åº¦&lt;/p&gt;
&lt;h3 id="ç¥ç»ç½‘ç»œçš„æ¢¯åº¦"&gt;ç¥ç»ç½‘ç»œçš„æ¢¯åº¦
&lt;/h3&gt;&lt;p&gt;ç¥ç»ç½‘ç»œçš„å­¦ä¹ ä¹Ÿè¦æ±‚æ¢¯åº¦ï¼Œè¿™é‡Œæ‰€è¯´çš„æ¢¯åº¦æ˜¯æŒ‡æŸå¤±å‡½æ•°å…³äºæƒé‡å‚æ•°çš„æ¢¯åº¦ï¼Œä¾‹å¦‚ä¸€ä¸ªå½¢çŠ¶2x3çš„æƒé‡$W$çš„ç¥ç»ç½‘ç»œï¼ŒæŸå¤±å‡½æ•°ç”¨Lè¡¨ç¤ºã€‚æ­¤æ—¶ï¼Œæ¢¯åº¦å¯ä»¥ç”¨$\frac{\partial L}{\partial \mathbf{W}}$è¡¨ç¤º
&lt;/p&gt;
$$
\mathbf{W} =
\begin{pmatrix}
w_{11} &amp; w_{12} &amp; w_{13} \\
w_{21} &amp; w_{22} &amp; w_{23}
\end{pmatrix}\\
\frac{\partial L}{\partial \mathbf{W}} =
\begin{pmatrix}
\frac{\partial L}{\partial w_{11}} &amp; \frac{\partial L}{\partial w_{12}} &amp; \frac{\partial L}{\partial w_{13}} \\
\frac{\partial L}{\partial w_{21}} &amp; \frac{\partial L}{\partial w_{22}} &amp; \frac{\partial L}{\partial w_{23}}
\end{pmatrix}\tag{5}
$$</description></item><item><title>é±¼ä¹¦ç¬”è®°-ç¥ç»ç½‘ç»œ(ä¸‹)</title><link>https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E4%B8%8B/</link><pubDate>Wed, 12 Nov 2025 00:00:00 +0000</pubDate><guid>https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E4%B8%8B/</guid><description>&lt;img src="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E4%B8%8B/pic3.jpg" alt="Featured image of post é±¼ä¹¦ç¬”è®°-ç¥ç»ç½‘ç»œ(ä¸‹)" /&gt;&lt;p&gt;&lt;strong&gt;ä»¥ä¸‹å†…å®¹çš†åŸºäºé±¼ä¹¦ã€Šæ·±åº¦å­¦ä¹ å…¥é—¨åŸºäºpythonçš„ç†è®ºä¸å®ç°ã€‹&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id="3å±‚ç¥ç»ç½‘ç»œçš„å®ç°"&gt;3å±‚ç¥ç»ç½‘ç»œçš„å®ç°
&lt;/h2&gt;&lt;p&gt;å¼€å§‹è¿›è¡Œç¥ç»ç½‘ç»œçš„å®ç°ï¼Œä»¥ä¸‹å›¾çš„ä¸‰å±‚ç¥ç»ç½‘ç»œä¸ºä¾‹&lt;/p&gt;
&lt;p&gt;&lt;img src="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E4%B8%8B/p1.jpg"
width="1042"
height="544"
srcset="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E4%B8%8B/p1_hu_6ed3140333fbfe21.jpg 480w, https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E4%B8%8B/p1_hu_ef4920c88ab22d8c.jpg 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="191"
data-flex-basis="459px"
&gt;&lt;/p&gt;
&lt;h3 id="ç¬¦å·ç¡®è®¤"&gt;ç¬¦å·ç¡®è®¤
&lt;/h3&gt;&lt;p&gt;é¦–å…ˆå¯¼å…¥ç¬¦å·$w_{12}^{(1)}$, $a_{1}^{(1)}$ç­‰ï¼Œå¦‚ä¸‹å›¾ï¼Œæƒé‡å’Œéšè—å±‚çš„ç¥ç»å…ƒå³ä¸Šè§’æœ‰ä¸€ä¸ª&amp;quot;(1)&amp;quot;ï¼Œå®ƒè¡¨ç¤ºæƒé‡å’Œç¥ç»å…ƒçš„å±‚å·ï¼Œæ­¤å¤–ï¼Œæƒé‡å³ä¸‹è§’çš„ä¸¤ä¸ªæ•°å­—ï¼Œå®ƒä»¬æ˜¯åä¸€å±‚çš„ç¥ç»å…ƒå’Œå‰ä¸€å±‚çš„ç¥ç»å…ƒçš„ç´¢å¼•å·ï¼Œæ¯”å¦‚$w_{12}^{(1)}$è¡¨ç¤ºå‰ä¸€å±‚çš„ç¬¬äºŒä¸ªç¥ç»å…ƒ$x_2$åˆ°åä¸€å±‚çš„ç¬¬1ä¸ªç¥ç»å…ƒ$a_{1}^{(1)}$çš„æƒé‡ã€‚æƒé‡å³ä¸‹è§’æŒ‰ç…§&amp;quot;åä¸€å±‚çš„ç´¢å¼•å·ã€å‰ä¸€å±‚çš„ç´¢å¼•å·&amp;quot;çš„é¡ºåºæ’åº&lt;/p&gt;
&lt;p&gt;&lt;img src="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E4%B8%8B/p2.jpg"
width="1016"
height="482"
srcset="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E4%B8%8B/p2_hu_c622ef8dc25b755.jpg 480w, https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E4%B8%8B/p2_hu_5a87340b1a46af20.jpg 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="210"
data-flex-basis="505px"
&gt;&lt;/p&gt;
&lt;h3 id="å„å±‚é—´ä¿¡å·ä¼ é€’çš„å®ç°"&gt;å„å±‚é—´ä¿¡å·ä¼ é€’çš„å®ç°
&lt;/h3&gt;&lt;p&gt;&lt;img src="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E4%B8%8B/p3.jpg"
width="1020"
height="624"
srcset="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E4%B8%8B/p3_hu_eb6e8c3a1231341d.jpg 480w, https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E4%B8%8B/p3_hu_6260c851cbcb0362.jpg 1024w"
loading="lazy"
alt="ä»è¾“å…¥å±‚åˆ°ç¬¬1å±‚çš„ä¿¡å·ä¼ é€’"
class="gallery-image"
data-flex-grow="163"
data-flex-basis="392px"
&gt;&lt;/p&gt;
&lt;p&gt;ä¸Šå›¾å¢åŠ äº†è¡¨ç¤ºåç½®çš„ç¥ç»å…ƒ&amp;quot;1&amp;quot;ã€‚åç½®çš„å³ä¸‹è§’çš„ç´¢å¼•å·åªæœ‰ä¸€ä¸ªå› ä¸ºå‰ä¸€å±‚çš„åç½®ç¥ç»å…ƒåªæœ‰ä¸€ä¸ª&lt;/p&gt;
&lt;p&gt;ç°åœ¨é€šè¿‡åŠ æƒä¿¡å·å’Œåç½®çš„å’Œè®¡ç®—è¡¨ç¤º$a_{1}^{(1)}$ã€‚
&lt;/p&gt;
$$
a_{1}^{(1)} = w_{11}^{(1)} x_{1} + w_{12}^{(1)} x_{2} + b_{1}^{(1)}\tag{8}
$$&lt;p&gt;
å¦‚æœç”¨çŸ©é˜µçš„ä¹˜æ³•è¿ç®—ï¼Œåˆ™å¯ä»¥å°†ç¬¬1å±‚çš„åŠ æƒå’Œè¡¨ç¤ºæˆä¸‹é¢çš„å¼(9)
&lt;/p&gt;
$$
A^{(1)} = XW^{(1)} + B^{(1)}
\tag{9}
$$&lt;p&gt;
å…¶ä¸­ï¼Œ$A^{(1)}$ã€$X$ã€$B^{(1)}$ã€$W^{(1)}$ å¦‚ä¸‹æ‰€ç¤ºï¼š
&lt;/p&gt;
$$
A^{(1)} = \begin{pmatrix}
a_{1}^{(1)} &amp; a_{2}^{(1)} &amp; a_{3}^{(1)}
\end{pmatrix},
\quad
X = \begin{pmatrix}
x_1 &amp; x_2
\end{pmatrix},
\quad
B^{(1)} = \begin{pmatrix}
b_{1}^{(1)} &amp; b_{2}^{(1)} &amp; b_{3}^{(1)}
\end{pmatrix}
$$$$
W^{(1)} = \begin{pmatrix}
w_{11}^{(1)} &amp; w_{21}^{(1)} &amp; w_{31}^{(1)} \\
w_{12}^{(1)} &amp; w_{22}^{(1)} &amp; w_{32}^{(1)}
\end{pmatrix}
$$&lt;p&gt;ç„¶åç”¨NumPyå¤šç»´æ•°ç»„æ¥å®ç°å¼(9)ï¼Œè¾“å…¥ä¿¡å·ï¼Œæƒé‡ï¼Œåç½®è®¾ç½®æˆä»»æ„å€¼&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;span class="lnt"&gt;6
&lt;/span&gt;&lt;span class="lnt"&gt;7
&lt;/span&gt;&lt;span class="lnt"&gt;8
&lt;/span&gt;&lt;span class="lnt"&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;X&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;W1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="mf"&gt;0.1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;0.3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;],[&lt;/span&gt;&lt;span class="mf"&gt;0.2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;0.4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;0.6&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;B1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;W1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# (2,3)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;#(2,)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;B1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;#(3.)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;A1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;W1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;B1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;W1æ˜¯2x3çš„æ•°ç»„ï¼ŒXæ˜¯å…ƒç´ ä¸ªæ•°ä¸º2çš„ä¸€ç»´æ•°ç»„ã€‚è¿™é‡Œï¼ŒW1å’ŒXçš„å¯¹åº”ç»´åº¦çš„å…ƒç´ ä¸ªæ•°ä¹Ÿä¿æŒäº†ä¸€è‡´ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åæˆ‘ä»¬ç”¨pythonæ¥å®ç°ç¬¬ä¸€å±‚æ¿€æ´»å‡½æ•°çš„è®¡ç®—è¿‡ç¨‹&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;Z1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sigmoid&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Z1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™é‡Œè¯´çš„sigmoidå‡½æ•°å°±æ˜¯ä¹‹å‰å®šä¹‰çš„é‚£ä¸ªï¼Œå®ƒä¼šæ¥æ”¶NumPyæ•°ç»„ï¼Œç„¶åè¿”å›å…ƒç´ ä¸ªæ•°ç›¸åŒçš„NumPyæ•°ç»„&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æˆ‘ä»¬æ¥å®ç°ç¬¬1å±‚åˆ°ç¬¬2å±‚çš„ä¿¡å·ä¼ é€’&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;span class="lnt"&gt;6
&lt;/span&gt;&lt;span class="lnt"&gt;7
&lt;/span&gt;&lt;span class="lnt"&gt;8
&lt;/span&gt;&lt;span class="lnt"&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;W2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="mf"&gt;0.1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;0.4&lt;/span&gt;&lt;span class="p"&gt;],[&lt;/span&gt;&lt;span class="mf"&gt;0.2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;],[&lt;/span&gt;&lt;span class="mf"&gt;0.3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;0.6&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;B2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mf"&gt;0.1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;0.2&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Z1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;#(3,)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;W2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;#(3,2)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;B2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;#(2,)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;A2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Z1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;W2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;B2&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;Z2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sigmoid&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;é™¤äº†ç¬¬ä¸€å±‚çš„è¾“å‡ºå˜æˆäº†ç¬¬äºŒå±‚çš„è¾“å…¥ï¼Œè¿™ä¸ªå®ç°å’Œåˆšæ‰çš„ä¸€æ ·&lt;/p&gt;
&lt;p&gt;æœ€åæ˜¯ç¬¬äºŒå±‚åˆ°è¾“å‡ºå±‚çš„ä¿¡å·ä¼ é€’ï¼Œè¾“å‡ºå±‚çš„å®ç°ä¹Ÿå’Œä¹‹å‰çš„å®ç°åŸºæœ¬ç›¸åŒï¼Œä¸è¿‡ï¼Œæœ€åçš„æ¿€æ´»å‡½æ•°å’Œä¹‹å‰çš„éšè—å±‚æœ‰æ‰€ä¸åŒ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;span class="lnt"&gt;6
&lt;/span&gt;&lt;span class="lnt"&gt;7
&lt;/span&gt;&lt;span class="lnt"&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;identity_function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;W3&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mf"&gt;0.1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;0.3&lt;/span&gt;&lt;span class="p"&gt;],[&lt;/span&gt;&lt;span class="mf"&gt;0.2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;0.4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;B3&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mf"&gt;0.1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;0.2&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;A3&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Z2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;W3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;B3&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;Y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;identity_function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™é‡Œå®šä¹‰äº†&lt;code&gt;identity_function()&lt;/code&gt;å‡½æ•°ï¼ˆæ’ç­‰å‡½æ•°ï¼‰ï¼Œå¹¶å°†å…¶ä½œä¸ºè¾“å‡ºå±‚çš„æ¿€æ´»å‡½æ•°ã€‚&lt;/p&gt;
&lt;h3 id="ä»£ç æ€»ç»“"&gt;ä»£ç æ€»ç»“
&lt;/h3&gt;&lt;p&gt;æŒ‰ç…§ç¥ç»ç½‘ç»œçš„å®ç°æƒ¯ä¾‹ï¼ŒæŠŠæƒé‡è®°ä¸ºå¤§å†™å­—æ¯W1ï¼Œå…¶ä»–éƒ½ç”¨å°å†™å­—æ¯è¡¨ç¤º&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;span class="lnt"&gt;20
&lt;/span&gt;&lt;span class="lnt"&gt;21
&lt;/span&gt;&lt;span class="lnt"&gt;22
&lt;/span&gt;&lt;span class="lnt"&gt;23
&lt;/span&gt;&lt;span class="lnt"&gt;24
&lt;/span&gt;&lt;span class="lnt"&gt;25
&lt;/span&gt;&lt;span class="lnt"&gt;26
&lt;/span&gt;&lt;span class="lnt"&gt;27
&lt;/span&gt;&lt;span class="lnt"&gt;28
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;init_network&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;network&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;network&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;W1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="mf"&gt;0.1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;0.2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.6&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;network&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;b1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mf"&gt;0.1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.3&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;network&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;W2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="mf"&gt;0.1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.4&lt;/span&gt;&lt;span class="p"&gt;],[&lt;/span&gt;&lt;span class="mf"&gt;0.2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;],[&lt;/span&gt;&lt;span class="mf"&gt;0.3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.6&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;network&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;b2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mf"&gt;0.1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.2&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;network&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;W3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="mf"&gt;0.1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.3&lt;/span&gt;&lt;span class="p"&gt;],[&lt;/span&gt;&lt;span class="mf"&gt;0.2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.4&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;network&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;b3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mf"&gt;0.1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.2&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;network&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;forward&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;network&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;W1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;W2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;W3&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;network&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;W1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="n"&gt;network&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;W2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="n"&gt;network&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;W3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;b1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b3&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;network&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;b1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="n"&gt;network&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;b2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="n"&gt;network&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;b3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;a1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;W1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;b1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;z1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sigmoid&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;a2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;z1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;W2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;b2&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;z2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sigmoid&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;a3&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;z2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;W3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;b3&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;identity_function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;network&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;init_network&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;forward&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;network&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# [ 0.31682708 0.69627909]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™é‡Œå®šä¹‰äº†&lt;code&gt;init_network()&lt;/code&gt;å’Œ&lt;code&gt;forward()&lt;/code&gt;å‡½æ•°ï¼Œ&lt;code&gt;init_network()&lt;/code&gt;å‡½æ•°ä¼šè¿›è¡Œæƒé‡å’Œåç½®çš„åˆå§‹åŒ–ï¼Œå¹¶å°†å®ƒä»¬ä¿å­˜åœ¨å­—å…¸å˜é‡networkä¸­ã€‚&lt;code&gt;forward()&lt;/code&gt;å‡½æ•°ä¸­åˆ™å°è£…äº†å°†è¾“å…¥ä¿¡å·è½¬æ¢ä¸ºè¾“å‡ºä¿¡å·çš„å¤„ç†è¿‡ç¨‹&lt;/p&gt;
&lt;h2 id="è¾“å‡ºå±‚çš„è®¾è®¡"&gt;è¾“å‡ºå±‚çš„è®¾è®¡
&lt;/h2&gt;&lt;p&gt;ç¥ç»ç½‘ç»œè¦æ ¹æ®æƒ…å†µæ”¹å˜è¾“å‡ºå±‚çš„æ¿€æ´»å‡½æ•°ã€‚ä¸€èˆ¬è€Œè¨€ï¼Œå›å½’é—®é¢˜ç”¨æ’ç­‰å‡½æ•°ï¼Œåˆ†ç±»é—®é¢˜ç”¨softmaxå‡½æ•°ã€‚&lt;/p&gt;
&lt;h3 id="æ’ç­‰å‡½æ•°å’Œsoftmaxå‡½æ•°"&gt;æ’ç­‰å‡½æ•°å’Œsoftmaxå‡½æ•°
&lt;/h3&gt;&lt;p&gt;æ’ç­‰å‡½æ•°ä¼šå°†è¾“å…¥æŒ‰åŸæ ·è¾“å‡º&lt;/p&gt;
&lt;p&gt;&lt;img src="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E4%B8%8B/p4.jpg"
width="458"
height="258"
srcset="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E4%B8%8B/p4_hu_6d65e9351df62c95.jpg 480w, https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E4%B8%8B/p4_hu_43b265d1cfa56ce1.jpg 1024w"
loading="lazy"
alt="æ’ç­‰å‡½æ•°"
class="gallery-image"
data-flex-grow="177"
data-flex-basis="426px"
&gt;&lt;/p&gt;
&lt;p&gt;åˆ†ç±»é—®é¢˜ä¸­çš„softmaxå‡½æ•°å¯ä»¥ç”¨ä¸‹é¢çš„å¼(10)è¡¨ç¤º
&lt;/p&gt;
$$
y_k = \frac{\exp(a_k)}{\sum_{i=1}^{n} \exp(a_i)}\tag{10}
$$&lt;p&gt;
ä¸Šå¼è¡¨ç¤ºå‡è®¾è¾“å‡ºå±‚å…±æœ‰nä¸ªç¥ç»å…ƒï¼Œè®¡ç®—ç¬¬kä¸ªç¥ç»å…ƒçš„è¾“å‡º$y_k$ï¼Œå¦‚å¼(10)æ‰€ç¤ºï¼Œsoftmaxå‡½æ•°çš„åˆ†å­æ˜¯è¾“å…¥ä¿¡å·$a_k$çš„æŒ‡æ•°å‡½æ•°ï¼Œåˆ†æ¯æ˜¯æ‰€æœ‰è¾“å…¥ä¿¡å·çš„æŒ‡æ•°å‡½æ•°çš„å’Œ&lt;/p&gt;
&lt;p&gt;&lt;img src="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E4%B8%8B/p5.jpg"
width="410"
height="262"
srcset="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E4%B8%8B/p5_hu_9b7e96258f08abca.jpg 480w, https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E4%B8%8B/p5_hu_6d634ae849e8b735.jpg 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="156"
data-flex-basis="375px"
&gt;&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥æ¥å®ç°softmaxå‡½æ•°ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;span class="lnt"&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;softmax&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;exp_a&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;sum_exp_a&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;exp_a&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;exp_a&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;sub_exp_a&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id="å®ç°softmaxå‡½æ•°æ—¶çš„æ³¨æ„äº‹é¡¹"&gt;å®ç°softmaxå‡½æ•°æ—¶çš„æ³¨æ„äº‹é¡¹
&lt;/h3&gt;&lt;p&gt;ä¸Šé¢çš„softmaxå‡½æ•°åœ¨è®¡ç®—ä¸Šæœ‰ä¸€å®šçš„ç¼ºé™·ï¼Œå°±æ˜¯æº¢å‡ºçš„é—®é¢˜ï¼Œsoftmaxå‡½æ•°çš„å®ç°ä¸­è¦è¿›è¡ŒæŒ‡æ•°å‡½æ•°çš„è¿ç®—ï¼Œä½†æ˜¯æ­¤æ—¶æŒ‡æ•°å‡½æ•°çš„å€¼å¾ˆå®¹æ˜“å˜å¾—éå¸¸å¤§ï¼Œæ¯”å¦‚$e^{1000}$çš„ç»“æœä¼šè¿”å›ä¸€ä¸ªè¡¨ç¤ºæ— ç©·å¤§å¤§infï¼Œåœ¨è¿™äº›è¶…å¤§å€¼ä¹‹é—´è¿›è¡Œé™¤æ³•è¿ç®—ï¼Œç»“æœä¼šå‡ºç°ä¸ç¡®å®šçš„æƒ…å†µï¼Œsoftmaxå¯ä»¥åƒå¦‚ä¸‹(11)æ”¹è¿›
&lt;/p&gt;
$$
\begin{aligned}
y_k &amp;= \frac{\exp(a_k)}{\sum_{i=1}^{n} \exp(a_i)}
= \frac{C \exp(a_k)}{C \sum_{i=1}^{n} \exp(a_i)} \\[6pt]
&amp;= \frac{\exp(a_k + \log C)}{\sum_{i=1}^{n} \exp(a_i + \log C)} \\[6pt]
&amp;= \frac{\exp(a_k + C')}{\sum_{i=1}^{n} \exp(a_i + C')}
\end{aligned}
\tag{11}
$$&lt;p&gt;
å…ˆåœ¨åˆ†å­å’Œåˆ†æ¯ä¸Šéƒ½ä¹˜ä»¥Cï¼ˆä¸€ä¸ªä»»æ„çš„å¸¸æ•°ï¼‰ï¼Œç„¶åæŠŠCç§»åŠ¨åˆ°æŒ‡æ•°å‡½æ•°ä¸­ï¼Œè®°ä¸º$log C$ã€‚æœ€åæŠŠ$logC$æ›¿æ¢ä¸ºå¦å¤–ä¸€ä¸ªç¬¦å·$C'$&lt;/p&gt;
&lt;p&gt;ç»¼ä¸Šï¼Œæˆ‘ä»¬æ¥å®ç°ä¸‹æœ€ç»ˆç‰ˆçš„softmaxå‡½æ•°&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;span class="lnt"&gt;6
&lt;/span&gt;&lt;span class="lnt"&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;softmax&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;exp_a&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;sum_exp_a&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np_sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;exp_a&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;exp_a&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;sum_exp_a&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id="softmaxå‡½æ•°çš„ç‰¹å¾"&gt;softmaxå‡½æ•°çš„ç‰¹å¾
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;è¾“å‡ºæ€»å’Œä¸º1ï¼Œå› ä¸ºè¿™ä¸ªæ€§è´¨æˆ‘ä»¬æ‰å¯ä»¥æŠŠsoftmaxå‡½æ•°çš„è¾“å‡ºè§£é‡Šä¸ºâ€œæ¦‚ç‡â€&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨äº†softmaxå‡½æ•°å„ä¸ªå…ƒç´ ä¹‹é—´çš„å¤§å°å…³ç³»ä¹Ÿä¸ä¼šæ”¹å˜ï¼Œå› ä¸ºexpæ˜¯å•è°ƒé€’å¢çš„&lt;/li&gt;
&lt;li&gt;ç¥ç»ç½‘ç»œä¸€èˆ¬åªä¼šæŠŠè¾“å‡ºå€¼æœ€å¤§çš„ç¥ç»å…ƒæ‰€å¯¹åº”çš„ç±»åˆ«ä½œä¸ºè¯†åˆ«ç»“æœã€‚ä½¿ç”¨softmaxå‡½æ•°è¾“å‡ºå€¼æœ€å¤§çš„ç¥ç»å…ƒçš„ä½ç½®ä¹Ÿä¸ä¼šå˜ï¼Œå› æ­¤è¾“å‡ºå±‚çš„softmaxå‡½æ•°ä¸€èˆ¬ä¼šè¢«å¿½ç•¥&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="è¾“å‡ºå±‚çš„ç¥ç»å…ƒæ•°é‡"&gt;è¾“å‡ºå±‚çš„ç¥ç»å…ƒæ•°é‡
&lt;/h3&gt;&lt;p&gt;è¾“å‡ºå±‚çš„ç¥ç»å…ƒæ•°é‡éœ€è¦æ ¹æ®å¾…è§£å†³çš„é—®é¢˜æ¥å†³å®šã€‚å¯¹äºåˆ†ç±»é—®é¢˜ï¼Œè¾“å‡ºå±‚çš„ç¥ç»å…ƒæ•°é‡ä¸€èˆ¬è®¾å®šä¸ºç±»åˆ«çš„æ•°é‡ã€‚æ¯”å¦‚ï¼Œå¯¹äºæŸä¸ªè¾“å…¥å›¾åƒï¼Œé¢„æµ‹æ˜¯å›¾ä¸­çš„æ•°å­—0åˆ°9ä¸­çš„å“ªä¸ªçš„é—®é¢˜ï¼Œå¯ä»¥æŠŠè¾“å‡ºå±‚çš„ç¥ç»å…ƒè®¾å®šä¸º10ä¸ªï¼Œç„¶åæŠŠè¿™åä¸ªç¥ç»å…ƒæŒ‰ç…§ä»ä¸Šåˆ°ä¸‹ï¼Œä»0-9ä¾æ¬¡ç¼–å·ï¼Œå¹¶ä¸”å€¼ç”¨ä¸åŒçš„ç°åº¦è¡¨ç¤ºï¼Œé¢œè‰²è¶Šæ·±ï¼Œè¾“å‡ºçš„å€¼å°±è¶Šå¤§&lt;/p&gt;
&lt;h2 id="æ‰‹å†™æ•°å­—è¯†åˆ«"&gt;æ‰‹å†™æ•°å­—è¯†åˆ«
&lt;/h2&gt;&lt;p&gt;å¼€å§‹è§£å†³å®é™…é—®é¢˜ï¼Œå‡è®¾å­¦ä¹ å·²ç»å…¨éƒ¨ç»“æŸï¼Œæˆ‘ä»¬ä½¿ç”¨å­¦ä¹ åˆ°çš„å‚æ•°ï¼Œå…ˆå®ç°ç¥ç»ç½‘ç»œçš„â€œæ¨ç†å¤„ç†â€ã€‚è¿™ä¸ªæ¨ç†å¤„ç†ä¹Ÿç§°ä¸ºç¥ç»ç½‘ç»œçš„&lt;strong&gt;å‰å‘ä¼ æ’­&lt;/strong&gt;ï¼ˆæ„Ÿè§‰è¿™å—æ˜¯çœ‹åˆ°ç°åœ¨ä¸ºæ­¢å”¯ä¸€ä¸€å—ä¸å¤ªæ‡‚çš„éƒ¨åˆ†ï¼‰&lt;/p&gt;
&lt;h3 id="mnistæ•°æ®é›†"&gt;MNISTæ•°æ®é›†
&lt;/h3&gt;&lt;p&gt;MNISTæ•°æ®é›†æ˜¯ç”±0åˆ°9çš„æ•°å­—å›¾åƒæ„æˆçš„ã€‚è®­ç»ƒå›¾åƒæœ‰6ä¸‡å¼ ï¼Œæµ‹è¯•å›¾åƒæœ‰1ä¸‡å¼ ï¼Œè¿™äº›å›¾åƒå¯ä»¥ç”¨äºå­¦ä¹ ä¸æ¨ç†ã€‚MNISTæ•°æ®é›†çš„ä¸€èˆ¬ä½¿ç”¨æ–¹æ³•æ˜¯ï¼Œå…ˆç”¨è®­ç»ƒå›¾åƒè¿›è¡Œå­¦ä¹ ï¼Œå†ç”¨å­¦ä¹ åˆ°çš„æ¨¡å‹åº¦é‡èƒ½åœ¨èƒ½åœ¨å¤šå¤§ç¨‹åº¦ä¸Šå¯¹æµ‹è¯•å›¾åƒè¿›è¡Œæ­£ç¡®çš„åˆ†ç±»&lt;/p&gt;
&lt;p&gt;MNISTçš„å›¾åƒæ•°æ®æ˜¯28åƒç´ x28åƒç´ çš„ç°åº¦å›¾åƒï¼ˆ1é€šé“ï¼‰ï¼Œå„ä¸ªåƒç´ çš„å–å€¼åœ¨0åˆ°255ä¹‹é—´ã€‚æ¯ä¸ªå›¾åƒéƒ½ç›¸åº”åœ°æ ‡æœ‰â€œ7â€ â€œ2â€ â€œ1â€ç­‰æ ‡ç­¾ã€‚&lt;/p&gt;
&lt;h2 id="ä»æ•°æ®ä¸­å­¦ä¹ "&gt;ä»æ•°æ®ä¸­å­¦ä¹ 
&lt;/h2&gt;&lt;h3 id="æ•°æ®é©±åŠ¨"&gt;æ•°æ®é©±åŠ¨
&lt;/h3&gt;&lt;p&gt;å¦‚ä½•å®ç°æ•°å­—â€œ5â€çš„è¯†åˆ«ï¼Œå¦‚æœè¦è®¾è®¡ä¸€ä¸ªèƒ½å°†5æ­£ç¡®åˆ†ç±»çš„ç¨‹åº&lt;/p&gt;</description></item><item><title>é±¼ä¹¦ç¬”è®°-ç¥ç»ç½‘ç»œ(ä¸Š)</title><link>https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E4%B8%8A/</link><pubDate>Mon, 10 Nov 2025 00:00:00 +0000</pubDate><guid>https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E4%B8%8A/</guid><description>&lt;img src="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E4%B8%8A/pic3.jpg" alt="Featured image of post é±¼ä¹¦ç¬”è®°-ç¥ç»ç½‘ç»œ(ä¸Š)" /&gt;&lt;p&gt;&lt;strong&gt;ä»¥ä¸‹å†…å®¹çš†åŸºäºé±¼ä¹¦ã€Šæ·±åº¦å­¦ä¹ å…¥é—¨åŸºäºpythonçš„ç†è®ºä¸å®ç°ã€‹&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id="ä»æ„ŸçŸ¥æœºåˆ°ç¥ç»ç½‘ç»œ"&gt;ä»æ„ŸçŸ¥æœºåˆ°ç¥ç»ç½‘ç»œ
&lt;/h2&gt;&lt;h3 id="æ„ŸçŸ¥æœºå›é¡¾"&gt;æ„ŸçŸ¥æœºå›é¡¾
&lt;/h3&gt;&lt;p&gt;ç”¨å›¾æ¥è¡¨ç¤ºç¥ç»ç½‘ç»œï¼Œç±»æ¯”æ„ŸçŸ¥æœºï¼Œæˆ‘ä»¬æŠŠå·¦è¾¹çš„ä¸€åˆ—ç§°ä¸º&lt;strong&gt;è¾“å…¥å±‚&lt;/strong&gt;ï¼Œæœ€å³è¾¹çš„ç§°ä¹‹ä¸º&lt;strong&gt;è¾“å‡ºå±‚&lt;/strong&gt;ï¼Œä¸­é—´çš„ç§°ä¸º&lt;strong&gt;ä¸­é—´å±‚&lt;/strong&gt;(ä¹Ÿç§°ä¸ºéšè—å±‚ï¼Œå› ä¸ºç¥ç»å…ƒè‚‰çœ¼çœ‹ä¸è§)ï¼Œæˆ‘ä»¬çŸ¥é“å½“æ„ŸçŸ¥æœºæ¥å—$x_1,x_2$ä¸¤ä¸ªè¾“å…¥ä¿¡å·ï¼Œè¾“å‡º$y$æ—¶ï¼Œå¯ä»¥ç”¨å¦‚ä¸‹çš„æ•°å­¦å¼æ¥è¡¨ç¤º
&lt;/p&gt;
$$
y =
\begin{cases}
0, &amp; b + w_1 x_1 + w_2 x_2 \le 0 \\
1, &amp; b + w_1 x_1 + w_2 x_2 &gt; 0
\end{cases}
\tag{1}
$$&lt;p&gt;
$b$æ˜¯åç½®ï¼Œç”¨äºæ§åˆ¶ç¥ç»å…ƒè¢«æ¿€æ´»çš„å®¹æ˜“ç¨‹åº¦ï¼Œè€Œ$w_1,w_2$æ˜¯è¡¨ç¤ºå„ä¸ªä¿¡å·çš„æƒé‡çš„å‚æ•°ï¼Œç”¨äºæ§åˆ¶å„ä¸ªä¿¡å·çš„é‡è¦æ€§&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ç°åœ¨å¯ä»¥é€šè¿‡è°ƒç”¨ä¸€ä¸ªå‡½æ•°æ¥æ›¿ä»£(1)ä¸­åˆ†caseè®¨è®ºçš„æƒ…å†µæ¥ç®€åŒ–(1)ï¼Œæ”¹å†™æˆå¦‚ä¸‹å½¢å¼
&lt;/p&gt;
$$
y = h(b + w_1x_1+ w_2x_2)\tag{2}
$$$$
h(x) =
\begin{cases}
0, &amp; x \le 0 \\
1, &amp; x &gt; 0
\end{cases}\tag{3}
$$&lt;h3 id="æ¿€æ´»å‡½æ•°å¼•å…¥"&gt;æ¿€æ´»å‡½æ•°å¼•å…¥
&lt;/h3&gt;&lt;p&gt;åˆšæ‰çš„h(x)æŠŠè¾“å…¥ä¿¡å·çš„æ€»å’Œè½¬æ¢æˆäº†è¾“å‡ºä¿¡å·ï¼Œh(x)å°±è¢«ç§°ä¸º&lt;strong&gt;æ¿€æ´»å‡½æ•°(activation function)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç°åœ¨è¿›ä¸€æ­¥æ”¹å†™å¼(2)ï¼Œå†™æˆå¦‚ä¸‹å½¢å¼
&lt;/p&gt;
$$
a = b + w_1x_1 + w_2x_2\tag{4}
$$$$
y = h(a)\tag{5}
$$&lt;p&gt;é¦–å…ˆï¼Œå¼(4)è®¡ç®—åŠ æƒè¾“å…¥ä¿¡å·çš„å’Œåç½®çš„æ€»å’Œï¼Œç„¶åç”¨(5)çš„hå‡½æ•°è½¬æ¢ä¸ºè¾“å‡º&lt;/p&gt;
&lt;h2 id="æ¿€æ´»å‡½æ•°"&gt;æ¿€æ´»å‡½æ•°
&lt;/h2&gt;&lt;h3 id="sigmoidå‡½æ•°"&gt;sigmoidå‡½æ•°
&lt;/h3&gt;&lt;p&gt;ç¥ç»ç½‘ç»œä¸­ç»å¸¸ä½¿ç”¨çš„ä¸€ä¸ªæ¿€æ´»å‡½æ•°å°±æ˜¯&lt;strong&gt;sigmoidå‡½æ•°&lt;/strong&gt;
&lt;/p&gt;
$$
h(x)=\frac{1}{1+e^{-x}} \quad (\text{sigmoid function})\tag{6}
$$&lt;p&gt;
å®é™…ä¸Šï¼Œæ„ŸçŸ¥æœºå’Œç¥ç»ç½‘ç»œçš„ä¸»è¦åŒºåˆ«å°±åœ¨äºæ¿€æ´»å‡½æ•°ï¼Œå…¶ä»–æ–¹é¢åŸºæœ¬éƒ½æ˜¯ä¸€æ ·çš„&lt;/p&gt;
&lt;h3 id="é˜¶è·ƒå‡½æ•°çš„å®ç°"&gt;é˜¶è·ƒå‡½æ•°çš„å®ç°
&lt;/h3&gt;&lt;p&gt;é˜¶è·ƒå‡½æ•°å¦‚(3)æ‰€ç¤ºï¼Œå½“è¾“å…¥è¶…è¿‡0æ—¶ï¼Œè¾“å‡º1ï¼Œå¦åˆ™è¾“å‡º0ï¼Œå¯ä»¥ç”¨å¦‚ä¸‹ä»£ç ç®€å•å®ç°&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;step_function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™ä¸ªä»£ç ä¸­å‚æ•°xåªèƒ½æ¥å—å®æ•°ã€‚ä¾‹å¦‚ä¸å…è®¸&lt;code&gt;step_function(np.array([1.0,2.0]))&lt;/code&gt;ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠå®ƒä¿®æ”¹ä¸ºæ”¯æŒNumPyæ•°ç»„çš„å®ç°&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;step_function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;astype&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;int&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id="é˜¶è·ƒå‡½æ•°çš„å›¾å½¢"&gt;é˜¶è·ƒå‡½æ•°çš„å›¾å½¢
&lt;/h3&gt;&lt;p&gt;æ¥ä¸‹æ¥æˆ‘ä»¬å°±ç”¨å›¾æ¥è¡¨ç¤ºä¸Šé¢å®šä¹‰çš„é˜¶è·ƒå‡½æ•°&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pylab&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;step_function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;dtype&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;int&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;5.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;5.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;0.1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;step_function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;1.1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;#yè½´èŒƒå›´&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E4%B8%8A/figure1.jpg"
width="640"
height="480"
srcset="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E4%B8%8A/figure1_hu_4edc352cb7851f7c.jpg 480w, https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E4%B8%8A/figure1_hu_893ac30a708dd13a.jpg 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="133"
data-flex-basis="320px"
&gt;&lt;/p&gt;
&lt;h3 id="sigmoidå‡½æ•°çš„å®ç°"&gt;sigmoidå‡½æ•°çš„å®ç°
&lt;/h3&gt;&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;sigmoid&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ä¹‹æ‰€ä»¥sigmoidå‡½æ•°çš„å®ç°æ”¯æŒNumPyæ•°ç»„ï¼Œå°±æ˜¯å› ä¸ºNumPyçš„å¹¿æ’­åŠŸèƒ½ï¼Œå¦‚æœåœ¨æ ‡é‡å’ŒNumPyæ•°ç»„ä¹‹é—´è¿›è¡Œè¿ç®—ï¼Œæ ‡é‡ä¼šå’ŒNumPyæ•°ç»„çš„å„ä¸ªå…ƒç´ è¿›è¡Œè¿ç®—ï¼Œ&lt;code&gt;np.exp(-x)&lt;/code&gt;ä¼šç”ŸæˆNumPyæ•°ç»„ï¼Œæ‰€ä»¥&lt;code&gt;1/(1 + np.exp(-x))&lt;/code&gt;çš„è¿ç®—å°†ä¼šåœ¨NumPyæ•°ç»„çš„å„ä¸ªå…ƒç´ é—´è¿›è¡Œ&lt;/p&gt;
&lt;h3 id="sigmoidå‡½æ•°å’Œé˜¶è·ƒå‡½æ•°çš„æ¯”è¾ƒ"&gt;sigmoidå‡½æ•°å’Œé˜¶è·ƒå‡½æ•°çš„æ¯”è¾ƒ
&lt;/h3&gt;&lt;p&gt;&lt;img src="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E4%B8%8A/pic4.jpg"
width="1070"
height="1034"
srcset="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E4%B8%8A/pic4_hu_15fd3252af9c0d75.jpg 480w, https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E4%B8%8A/pic4_hu_8cd92bb4638acb60.jpg 1024w"
loading="lazy"
alt="é˜¶è·ƒå‡½æ•°ä¸sigmoidå‡½æ•°"
class="gallery-image"
data-flex-grow="103"
data-flex-basis="248px"
&gt;&lt;/p&gt;
&lt;p&gt;è§‚å¯Ÿå¯ä»¥å‘ç°ï¼Œé¦–å…ˆåŒºåˆ«å°±æ˜¯å¹³æ»‘æ€§ï¼Œsigmoidå‡½æ•°æ˜¯ä¸€æ¡å¹³æ»‘çš„æ›²çº¿ï¼Œè¾“å‡ºéšç€è¾“å…¥å‘ç”Ÿè¿ç»­æ€§çš„å˜åŒ–ã€‚è€Œé˜¶è·ƒå‡½æ•°ä»¥0ä¸ºç•Œï¼Œè¾“å‡ºå‘ç”Ÿæ€¥å‰§æ€§çš„å˜åŒ–ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œæ„ŸçŸ¥æœºçš„ç¥ç»å…ƒä¹‹é—´æµåŠ¨çš„æ˜¯0æˆ–1çš„äºŒå…ƒä¿¡å·ï¼Œç¥ç»ç½‘ç»œä¸­æµåŠ¨çš„æ˜¯è¿ç»­çš„å®æ•°å€¼ä¿¡å·ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åè¯´ä¸€ä¸‹é˜¶è·ƒå‡½æ•°å’Œsigmoidå‡½æ•°çš„å…±åŒæ€§è´¨ï¼Œä¸¤è€…çš„ç»“æ„å‡æ˜¯â€œè¾“å…¥å°æ—¶è¾“å‡ºæ¥è¿‘0ï¼›è¾“å…¥å¤§æ—¶ï¼Œè¾“å‡ºé è¿‘1â€ï¼Œä»¥åŠä¸ç®¡è¾“å…¥æ˜¯ä»€ä¹ˆå€¼ï¼Œè¾“å‡ºä¿¡å·çš„å€¼éƒ½åœ¨0å’Œ1ä¸­é—´&lt;/p&gt;
&lt;h3 id="éçº¿æ€§å‡½æ•°"&gt;éçº¿æ€§å‡½æ•°
&lt;/h3&gt;&lt;p&gt;é˜¶è·ƒå‡½æ•°å’Œsigmoidå‡½æ•°éƒ½æ˜¯éçº¿æ€§å‡½æ•°&lt;/p&gt;
&lt;p&gt;ç¥ç»ç½‘ç»œçš„æ¿€æ´»å‡½æ•°å¿…é¡»ä½¿ç”¨éçº¿æ€§å‡½æ•°ï¼Œå› ä¸ºå¦‚æœä½¿ç”¨çº¿æ€§å‡½æ•°ï¼ŒåŠ æ·±ç¥ç»ç½‘ç»œçš„å±‚æ•°å°±æ²¡æœ‰æ„ä¹‰äº†ï¼ˆåº”è¯¥å¾ˆå¥½ç†è§£ï¼Œå¾ˆå¤šçº¿å‹å‡½æ•°å¤åˆä»ç„¶æ˜¯çº¿æ€§çš„ï¼Œå°±ä¸å…·ä½“è¯´äº†ï¼‰&lt;/p&gt;
&lt;h3 id="reluå‡½æ•°"&gt;ReLUå‡½æ•°
&lt;/h3&gt;&lt;p&gt;æœ€è¿‘æ¯”è¾ƒå¸¸è§çš„æ˜¯ReLUå‡½æ•°&lt;/p&gt;
&lt;p&gt;ReLUå‡½æ•°åœ¨è¾“å…¥å¤§äº0æ—¶ï¼Œç›´æ¥è¾“å‡ºè¯¥å€¼ï¼›åœ¨è¾“å…¥å°äºç­‰äº0çš„æ—¶å€™ï¼Œè¾“å‡º0&lt;/p&gt;
&lt;p&gt;&lt;img src="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E4%B8%8A/pic5.jpg"
width="1088"
height="716"
srcset="https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E4%B8%8A/pic5_hu_643511c3d68d1186.jpg 480w, https://lunatide.tech/p/%E9%B1%BC%E4%B9%A6%E7%AC%94%E8%AE%B0-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E4%B8%8A/pic5_hu_6dbfa2b46e66261.jpg 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="151"
data-flex-basis="364px"
&gt;&lt;/p&gt;
&lt;p&gt;ReLUå‡½æ•°å¯ä»¥è¡¨ç¤ºä¸ºä»¥ä¸‹æ•°å­¦å¼
&lt;/p&gt;
$$
h(x) =\begin{cases}
x, &amp; x &gt; 0 \\
0, &amp; x \le 0
\end{cases}
\tag{7}
$$&lt;p&gt;
ReLUå‡½æ•°çš„å®ç°ä¹Ÿéå¸¸ç®€å•&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;relu&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;maximum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id="å¤šç»´æ•°ç»„çš„è¿ç®—"&gt;å¤šç»´æ•°ç»„çš„è¿ç®—
&lt;/h2&gt;&lt;h3 id="å¤šç»´æ•°ç»„"&gt;å¤šç»´æ•°ç»„
&lt;/h3&gt;&lt;p&gt;é¦–å…ˆå‡å®šæœ‰ä¸€ä¸ªä¸€ç»´æ•°ç»„&lt;code&gt;A = np.array[1,2,3,4]&lt;/code&gt;ï¼Œæ•°ç»„çš„ç»´æ•°å¯ä»¥é€šè¿‡&lt;code&gt;np.ndim&lt;/code&gt;å¾—åˆ°ã€‚æ•°ç»„çš„å½¢çŠ¶å¯ä»¥é€šè¿‡å®ä¾‹å˜é‡shapeè·å¾—ï¼ŒAç”±å››ä¸ªå…ƒç´ æ„æˆï¼Œæ˜¯ä¸€ç»´çš„ï¼Œæ‰€ä»¥A.shapeå°±æ˜¯ï¼ˆ4ï¼Œï¼‰ï¼Œè¿™ä¸ªç»“æœæ˜¯ä¸ªå…ƒç»„ï¼Œè¿™ä¸ªä¸€ç»´æ•°ç»„ä¸ºäº†ä¿è¯å’Œå¤šç»´ä¸€æ ·çš„æ ¼å¼ï¼Œæ‰€ä»¥ä»ç„¶è¢«å†™æˆå…ƒç»„&lt;/p&gt;
&lt;h3 id="çŸ©é˜µä¹˜æ³•"&gt;çŸ©é˜µä¹˜æ³•
&lt;/h3&gt;&lt;p&gt;ä¸å†èµ˜è¿°&lt;/p&gt;
&lt;h3 id="ç¥ç»ç½‘ç»œçš„å†…ç§¯"&gt;ç¥ç»ç½‘ç»œçš„å†…ç§¯
&lt;/h3&gt;</description></item></channel></rss>